<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Knowledge acquisition personal's notes, blog drafts"><link href=https://jeromeboyer.net/java/quarkus/ rel=canonical><link href=../openliberty/ rel=prev><link href=../restassured/ rel=next><link rel=icon href=../../images/logo-blue.drawio.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.5.39"><title>Quarkus - Jerome Boyer's Personal Site</title><link rel=stylesheet href=../../assets/stylesheets/main.8c3ca2c6.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../extra.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#quarkus-summary-and-trick class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="Jerome Boyer's Personal Site" class="md-header__button md-logo" aria-label="Jerome Boyer's Personal Site" data-md-component=logo> <img src=../../images/logo.drawio.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Jerome Boyer's Personal Site </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Quarkus </span> </div> </div> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/jbcodeforce/jbcodeforce.github.io/ title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../about/ class=md-tabs__link> Home </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../../coding/playground/ class=md-tabs__link> Coding </a> </li> <li class=md-tabs__item> <a href=../../blogs/consultant-job/ class=md-tabs__link> Knowledge base </a> </li> <li class=md-tabs__item> <a href=../../techno/apicurio/ class=md-tabs__link> Techno </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="Jerome Boyer's Personal Site" class="md-nav__button md-logo" aria-label="Jerome Boyer's Personal Site" data-md-component=logo> <img src=../../images/logo.drawio.png alt=logo> </a> Jerome Boyer's Personal Site </label> <div class=md-nav__source> <a href=https://github.com/jbcodeforce/jbcodeforce.github.io/ title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_1> <label class=md-nav__link for=__nav_1 id=__nav_1_label tabindex=0> <span class=md-ellipsis> Home </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_1_label aria-expanded=false> <label class=md-nav__title for=__nav_1> <span class="md-nav__icon md-icon"></span> Home </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../about/ class=md-nav__link> <span class=md-ellipsis> About </span> </a> </li> <li class=md-nav__item> <a href=../../skills/ class=md-nav__link> <span class=md-ellipsis> Skills </span> </a> </li> <li class=md-nav__item> <a href=../../blogs/ class=md-nav__link> <span class=md-ellipsis> Blogs </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_1_4> <label class=md-nav__link for=__nav_1_4 id=__nav_1_4_label tabindex=0> <span class=md-ellipsis> Leasure </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_1_4_label aria-expanded=false> <label class=md-nav__title for=__nav_1_4> <span class="md-nav__icon md-icon"></span> Leasure </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../astronomy/ class=md-nav__link> <span class=md-ellipsis> Astronomy </span> </a> </li> <li class=md-nav__item> <a href=../../astronomy/physic/ class=md-nav__link> <span class=md-ellipsis> Physic - Newton </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2 checked> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex> <span class=md-ellipsis> Coding </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=true> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Coding </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../coding/playground/ class=md-nav__link> <span class=md-ellipsis> Playground </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_2> <label class=md-nav__link for=__nav_2_2 id=__nav_2_2_label tabindex=0> <span class=md-ellipsis> Dev & Ops </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2_2> <span class="md-nav__icon md-icon"></span> Dev & Ops </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../coding/agile/ class=md-nav__link> <span class=md-ellipsis> Agile </span> </a> </li> <li class=md-nav__item> <a href=../../coding/git/ class=md-nav__link> <span class=md-ellipsis> Git summary </span> </a> </li> <li class=md-nav__item> <a href=../../coding/gitops/ class=md-nav__link> <span class=md-ellipsis> GitOps </span> </a> </li> <li class=md-nav__item> <a href=../../coding/tekton/ class=md-nav__link> <span class=md-ellipsis> Tekton </span> </a> </li> <li class=md-nav__item> <a href=../../coding/argocd/ class=md-nav__link> <span class=md-ellipsis> ArgoCD </span> </a> </li> <li class=md-nav__item> <a href=../../coding/finch/ class=md-nav__link> <span class=md-ellipsis> Finch </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3> <label class=md-nav__link for=__nav_2_3 id=__nav_2_3_label tabindex=0> <span class=md-ellipsis> Fun problems </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_3_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3> <span class="md-nav__icon md-icon"></span> Fun problems </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../fun/puzzles/ class=md-nav__link> <span class=md-ellipsis> puzzles </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_4 checked> <label class=md-nav__link for=__nav_2_4 id=__nav_2_4_label tabindex=0> <span class=md-ellipsis> Java </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_4_label aria-expanded=true> <label class=md-nav__title for=__nav_2_4> <span class="md-nav__icon md-icon"></span> Java </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../ class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class=md-nav__item> <a href=../FAQ/ class=md-nav__link> <span class=md-ellipsis> Java FAQ </span> </a> </li> <li class=md-nav__item> <a href=../concurrent/ class=md-nav__link> <span class=md-ellipsis> Concurrency </span> </a> </li> <li class=md-nav__item> <a href=../funqy/ class=md-nav__link> <span class=md-ellipsis> Funqy </span> </a> </li> <li class=md-nav__item> <a href=../microprofile/ class=md-nav__link> <span class=md-ellipsis> Microprofile 3.x </span> </a> </li> <li class=md-nav__item> <a href=../openliberty/ class=md-nav__link> <span class=md-ellipsis> Open Liberty </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Quarkus </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Quarkus </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#value-propositions class=md-nav__link> <span class=md-ellipsis> Value Propositions </span> </a> </li> <li class=md-nav__item> <a href=#getting-started class=md-nav__link> <span class=md-ellipsis> Getting Started </span> </a> <nav class=md-nav aria-label="Getting Started"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#quarkus-cli class=md-nav__link> <span class=md-ellipsis> Quarkus CLI </span> </a> </li> <li class=md-nav__item> <a href=#create-a-project class=md-nav__link> <span class=md-ellipsis> Create a project </span> </a> </li> <li class=md-nav__item> <a href=#package-run class=md-nav__link> <span class=md-ellipsis> Package &amp; run </span> </a> </li> <li class=md-nav__item> <a href=#debug-within-vscode class=md-nav__link> <span class=md-ellipsis> Debug within VSCode </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#other-maven-quarkus-cli class=md-nav__link> <span class=md-ellipsis> Other Maven Quarkus CLI </span> </a> <nav class=md-nav aria-label="Other Maven Quarkus CLI"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#add-capabilities class=md-nav__link> <span class=md-ellipsis> Add capabilities </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#docker-build class=md-nav__link> <span class=md-ellipsis> Docker build </span> </a> </li> <li class=md-nav__item> <a href=#openapi class=md-nav__link> <span class=md-ellipsis> OpenAPI </span> </a> </li> <li class=md-nav__item> <a href=#running-on-openshift class=md-nav__link> <span class=md-ellipsis> Running on OpenShift </span> </a> <nav class=md-nav aria-label="Running on OpenShift"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#play-with-environment-variables class=md-nav__link> <span class=md-ellipsis> Play with environment variables </span> </a> </li> <li class=md-nav__item> <a href=#some-reusable-configuration class=md-nav__link> <span class=md-ellipsis> Some reusable configuration </span> </a> </li> <li class=md-nav__item> <a href=#remote-dev-mode class=md-nav__link> <span class=md-ellipsis> Remote dev mode </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#testing-with-quarkus class=md-nav__link> <span class=md-ellipsis> Testing with Quarkus </span> </a> <nav class=md-nav aria-label="Testing with Quarkus"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#maven-profile-and-quarkus-test class=md-nav__link> <span class=md-ellipsis> Maven profile and quarkus test </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#vue-app-with-quarkus-app class=md-nav__link> <span class=md-ellipsis> Vue app with quarkus app </span> </a> </li> <li class=md-nav__item> <a href=#reactive-crud-app-with-postgres class=md-nav__link> <span class=md-ellipsis> Reactive CRUD app with Postgres </span> </a> </li> <li class=md-nav__item> <a href=#command-mode-application class=md-nav__link> <span class=md-ellipsis> Command mode application </span> </a> </li> <li class=md-nav__item> <a href=#development-practices class=md-nav__link> <span class=md-ellipsis> Development practices </span> </a> <nav class=md-nav aria-label="Development practices"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#configuration class=md-nav__link> <span class=md-ellipsis> Configuration </span> </a> </li> <li class=md-nav__item> <a href=#get-access-to-start-and-stop-application-events class=md-nav__link> <span class=md-ellipsis> Get access to start and stop application events </span> </a> </li> <li class=md-nav__item> <a href=#testing-with-moquito class=md-nav__link> <span class=md-ellipsis> Testing with Moquito </span> </a> </li> <li class=md-nav__item> <a href=#reactive-with-mutiny class=md-nav__link> <span class=md-ellipsis> Reactive with Mutiny </span> </a> </li> <li class=md-nav__item> <a href=#reactive-messaging class=md-nav__link> <span class=md-ellipsis> Reactive messaging </span> </a> </li> <li class=md-nav__item> <a href=#a-case-for-kafka-to-sse class=md-nav__link> <span class=md-ellipsis> A case for Kafka to SSE </span> </a> </li> <li class=md-nav__item> <a href=#rest-client class=md-nav__link> <span class=md-ellipsis> REST Client </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#adopting-vertx class=md-nav__link> <span class=md-ellipsis> Adopting Vertx </span> </a> </li> <li class=md-nav__item> <a href=#typical-problems class=md-nav__link> <span class=md-ellipsis> Typical problems </span> </a> <nav class=md-nav aria-label="Typical problems"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#running-cloud-native class=md-nav__link> <span class=md-ellipsis> Running cloud native </span> </a> </li> <li class=md-nav__item> <a href=#run-quarkus-test-with-external-components-started-with-docker-compose class=md-nav__link> <span class=md-ellipsis> Run quarkus test with external components started with docker compose </span> </a> </li> <li class=md-nav__item> <a href=#cheat-sheet class=md-nav__link> <span class=md-ellipsis> Cheat-Sheet </span> </a> </li> <li class=md-nav__item> <a href=#to-read class=md-nav__link> <span class=md-ellipsis> To read </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../restassured/ class=md-nav__link> <span class=md-ellipsis> Rest assured </span> </a> </li> <li class=md-nav__item> <a href=../springcloud/ class=md-nav__link> <span class=md-ellipsis> SpringCloud </span> </a> </li> <li class=md-nav__item> <a href=../../coding/testcontainer/ class=md-nav__link> <span class=md-ellipsis> TestContainer </span> </a> </li> <li class=md-nav__item> <a href=../vertx/ class=md-nav__link> <span class=md-ellipsis> Vert.x </span> </a> </li> <li class=md-nav__item> <a href=../java-vscode/ class=md-nav__link> <span class=md-ellipsis> VScode </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../techno/podman/ class=md-nav__link> <span class=md-ellipsis> Podman </span> </a> </li> <li class=md-nav__item> <a href=../../coding/reactjs/ class=md-nav__link> <span class=md-ellipsis> React.js & next.js </span> </a> </li> <li class=md-nav__item> <a href=../../coding/istio/ class=md-nav__link> <span class=md-ellipsis> istio </span> </a> </li> <li class=md-nav__item> <a href=https://jbcodeforce.github.io/python-code class=md-nav__link> <span class=md-ellipsis> Python </span> </a> </li> <li class=md-nav__item> <a href=../../coding/knative/ class=md-nav__link> <span class=md-ellipsis> Knative </span> </a> </li> <li class=md-nav__item> <a href=https://jbcodeforce.github.io/vuejs-studies/ class=md-nav__link> <span class=md-ellipsis> Vue.js Studies </span> </a> </li> <li class=md-nav__item> <a href=https://cloudnative101.dev/ class=md-nav__link> <span class=md-ellipsis> Cloud native content IBM </span> </a> </li> <li class=md-nav__item> <a href=https://jbcodeforce.github.io/angular-sandbox/ class=md-nav__link> <span class=md-ellipsis> Angular </span> </a> </li> <li class=md-nav__item> <a href=../../code-template/ class=md-nav__link> <span class=md-ellipsis> My code templates </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class=md-ellipsis> Knowledge base </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Knowledge base </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../blogs/consultant-job/ class=md-nav__link> <span class=md-ellipsis> The SA job </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_2> <label class=md-nav__link for=__nav_3_2 id=__nav_3_2_label tabindex=0> <span class=md-ellipsis> Leadership </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_2_label aria-expanded=false> <label class=md-nav__title for=__nav_3_2> <span class="md-nav__icon md-icon"></span> Leadership </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../leadership/first-90-days/ class=md-nav__link> <span class=md-ellipsis> 90 Days </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_3> <label class=md-nav__link for=__nav_3_3 id=__nav_3_3_label tabindex=0> <span class=md-ellipsis> Architecture </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3_3> <span class="md-nav__icon md-icon"></span> Architecture </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../architecture/system-design/ class=md-nav__link> <span class=md-ellipsis> Conduct System Design </span> </a> </li> <li class=md-nav__item> <a href=https://jbcodeforce.github.io/eda-studies class=md-nav__link> <span class=md-ellipsis> Event Driven Architecture </span> </a> </li> <li class=md-nav__item> <a href=../../architecture/tcpip/ class=md-nav__link> <span class=md-ellipsis> TPC/IP summary </span> </a> </li> <li class=md-nav__item> <a href=../../architecture/flow-architectures/ class=md-nav__link> <span class=md-ellipsis> Flow architectures </span> </a> </li> <li class=md-nav__item> <a href=../../architecture/streaming/ class=md-nav__link> <span class=md-ellipsis> Streaming processing </span> </a> </li> <li class=md-nav__item> <a href=../../architecture/architectural-decisions/ class=md-nav__link> <span class=md-ellipsis> Architecture decision </span> </a> </li> <li class=md-nav__item> <a href="https://jbcodef orce.github.io/eda-studies/ddd" class=md-nav__link> <span class=md-ellipsis> DDD </span> </a> </li> <li class=md-nav__item> <a href=../../architecture/DR/ class=md-nav__link> <span class=md-ellipsis> Disaster recovery </span> </a> </li> <li class=md-nav__item> <a href=../../coding/istio/ class=md-nav__link> <span class=md-ellipsis> istio </span> </a> </li> <li class=md-nav__item> <a href=https://jbcodeforce.github.io/openshift-studies class=md-nav__link> <span class=md-ellipsis> Openshift Studies </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_4> <label class=md-nav__link for=__nav_3_4 id=__nav_3_4_label tabindex=0> <span class=md-ellipsis> Methodology </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_4_label aria-expanded=false> <label class=md-nav__title for=__nav_3_4> <span class="md-nav__icon md-icon"></span> Methodology </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../methodology/design-thinking/ class=md-nav__link> <span class=md-ellipsis> Design Thinking </span> </a> </li> <li class=md-nav__item> <a href=../../methodology/data-intensive/ class=md-nav__link> <span class=md-ellipsis> Data intensive </span> </a> </li> <li class=md-nav__item> <a href=https://jbcodeforce.github.io/eda-studies/event-storming/ class=md-nav__link> <span class=md-ellipsis> Event Storming </span> </a> </li> <li class=md-nav__item> <a href=https://jbcodeforce.github.io/eda-studies/ddd/ class=md-nav__link> <span class=md-ellipsis> Domain driven design </span> </a> </li> <li class=md-nav__item> <a href=../../methodology/lean-startup/ class=md-nav__link> <span class=md-ellipsis> Lean startup </span> </a> </li> <li class=md-nav__item> <a href=../../methodology/pm/ class=md-nav__link> <span class=md-ellipsis> Product manager </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_4_7> <label class=md-nav__link for=__nav_3_4_7 id=__nav_3_4_7_label tabindex=0> <span class=md-ellipsis> ABRD </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_3_4_7_label aria-expanded=false> <label class=md-nav__title for=__nav_3_4_7> <span class="md-nav__icon md-icon"></span> ABRD </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../methodology/abrd/ class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class=md-nav__item> <a href=../../methodology/abrd/concept/ class=md-nav__link> <span class=md-ellipsis> Concepts </span> </a> </li> <li class=md-nav__item> <a href=../../methodology/abrd/harvesting/ class=md-nav__link> <span class=md-ellipsis> Rule Harvesting </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../methodology/narrative/ class=md-nav__link> <span class=md-ellipsis> Narratives </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_5> <label class=md-nav__link for=__nav_3_5 id=__nav_3_5_label tabindex=0> <span class=md-ellipsis> Data </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_5_label aria-expanded=false> <label class=md-nav__title for=__nav_3_5> <span class="md-nav__icon md-icon"></span> Data </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../data/ class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class=md-nav__item> <a href=../../techno/data/ class=md-nav__link> <span class=md-ellipsis> Iceberg & others </span> </a> </li> <li class=md-nav__item> <a href=https://jbcodeforce.github.io/db-play/ class=md-nav__link> <span class=md-ellipsis> Database play </span> </a> </li> <li class=md-nav__item> <a href=../../data/data-topology/ class=md-nav__link> <span class=md-ellipsis> Data topology </span> </a> </li> <li class=md-nav__item> <a href=../../data/data-integration/ class=md-nav__link> <span class=md-ellipsis> Data integration </span> </a> </li> <li class=md-nav__item> <a href=../../data/data-replication/ class=md-nav__link> <span class=md-ellipsis> Data replication </span> </a> </li> <li class=md-nav__item> <a href=../../data/data-partitioning/ class=md-nav__link> <span class=md-ellipsis> Data partitioning </span> </a> </li> <li class=md-nav__item> <a href=../../architecture/streaming/ class=md-nav__link> <span class=md-ellipsis> Streaming processing </span> </a> </li> <li class=md-nav__item> <a href=../../architecture/opendatahub/ class=md-nav__link> <span class=md-ellipsis> OpenData Hub </span> </a> </li> <li class=md-nav__item> <a href=../../data/olap/ class=md-nav__link> <span class=md-ellipsis> OLAP </span> </a> </li> <li class=md-nav__item> <a href=../../data/cassandra/ class=md-nav__link> <span class=md-ellipsis> Cassandra </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_6> <label class=md-nav__link for=__nav_3_6 id=__nav_3_6_label tabindex=0> <span class=md-ellipsis> AI </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_6_label aria-expanded=false> <label class=md-nav__title for=__nav_3_6> <span class="md-nav__icon md-icon"></span> AI </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=https://jbcodeforce.github.io/ML-studies/#machine-learning class=md-nav__link> <span class=md-ellipsis> Machine learning </span> </a> </li> <li class=md-nav__item> <a href=https://jbcodeforce.github.io/ML-studies/ml/deep-learning/ class=md-nav__link> <span class=md-ellipsis> Deep learning </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0> <span class=md-ellipsis> Techno </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Techno </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../techno/apicurio/ class=md-nav__link> <span class=md-ellipsis> Apicurio </span> </a> </li> <li class=md-nav__item> <a href=../../techno/atlas/ class=md-nav__link> <span class=md-ellipsis> Atlas </span> </a> </li> <li class=md-nav__item> <a href=https://jbcodeforce.github.io/yarfba class=md-nav__link> <span class=md-ellipsis> AWS body of knowledge </span> </a> </li> <li class=md-nav__item> <a href=../../techno/code-engine/ class=md-nav__link> <span class=md-ellipsis> Code Engine </span> </a> </li> <li class=md-nav__item> <a href=../../techno/databricks/ class=md-nav__link> <span class=md-ellipsis> Databricks </span> </a> </li> <li class=md-nav__item> <a href=../../techno/docker/ class=md-nav__link> <span class=md-ellipsis> Docker </span> </a> </li> <li class=md-nav__item> <a href=../../techno/decisions/drools/ class=md-nav__link> <span class=md-ellipsis> Drools </span> </a> </li> <li class=md-nav__item> <a href=../../techno/egeria/ class=md-nav__link> <span class=md-ellipsis> Egeria </span> </a> </li> <li class=md-nav__item> <a href=../../techno/elasticsrch/ class=md-nav__link> <span class=md-ellipsis> Elastic Search </span> </a> </li> <li class=md-nav__item> <a href=https://jbcodeforce.github.io/flink-studies/ class=md-nav__link> <span class=md-ellipsis> Flink Studies </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_11> <label class=md-nav__link for=__nav_4_11 id=__nav_4_11_label tabindex=0> <span class=md-ellipsis> IBM </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_11_label aria-expanded=false> <label class=md-nav__title for=__nav_4_11> <span class="md-nav__icon md-icon"></span> IBM </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../architecture/ibmcloud/ class=md-nav__link> <span class=md-ellipsis> IBM Cloud </span> </a> </li> <li class=md-nav__item> <a href=../../architecture/satellite/ class=md-nav__link> <span class=md-ellipsis> IBM Cloud Satellite </span> </a> </li> <li class=md-nav__item> <a href=../../techno/cos/ class=md-nav__link> <span class=md-ellipsis> Cloud object storage </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_11_4> <label class=md-nav__link for=__nav_4_11_4 id=__nav_4_11_4_label tabindex=0> <span class=md-ellipsis> Cloud Pak Automation </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_4_11_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4_11_4> <span class="md-nav__icon md-icon"></span> Cloud Pak Automation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../techno/cp4a/ class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=../../techno/cp4a/bai/ class=md-nav__link> <span class=md-ellipsis> BAI </span> </a> </li> <li class=md-nav__item> <a href=../../techno/cp4a/odm/ class=md-nav__link> <span class=md-ellipsis> ODM </span> </a> </li> <li class=md-nav__item> <a href=../../techno/cp4a/ads/ class=md-nav__link> <span class=md-ellipsis> Automation Decision Service </span> </a> </li> <li class=md-nav__item> <a href=../../techno/cp4a/process-mining/ class=md-nav__link> <span class=md-ellipsis> Process mining </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_11_5> <label class=md-nav__link for=__nav_4_11_5 id=__nav_4_11_5_label tabindex=0> <span class=md-ellipsis> Cloud Pak integration </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_4_11_5_label aria-expanded=false> <label class=md-nav__title for=__nav_4_11_5> <span class="md-nav__icon md-icon"></span> Cloud Pak integration </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../techno/integration/cp4i/ class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=../../techno/integration/apic/ class=md-nav__link> <span class=md-ellipsis> APIC </span> </a> </li> <li class=md-nav__item> <a href=../../techno/integration/eepm/ class=md-nav__link> <span class=md-ellipsis> EEPM </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_11_5_4> <label class=md-nav__link for=__nav_4_11_5_4 id=__nav_4_11_5_4_label tabindex=0> <span class=md-ellipsis> MQ </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_4_11_5_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4_11_5_4> <span class="md-nav__icon md-icon"></span> MQ </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../techno/integration/mq/ class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=../mqChallenge/ class=md-nav__link> <span class=md-ellipsis> MQ challenge </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=https://jbcodeforce.github.io/kafka-studies class=md-nav__link> <span class=md-ellipsis> Kafka Studies </span> </a> </li> <li class=md-nav__item> <a href=../../techno/kar/ class=md-nav__link> <span class=md-ellipsis> KAR </span> </a> </li> <li class=md-nav__item> <a href=../../techno/microcks/ class=md-nav__link> <span class=md-ellipsis> Microcks </span> </a> </li> <li class=md-nav__item> <a href=../../techno/minikube/ class=md-nav__link> <span class=md-ellipsis> Minikube </span> </a> </li> <li class=md-nav__item> <a href=../../techno/podman/ class=md-nav__link> <span class=md-ellipsis> Podman </span> </a> </li> <li class=md-nav__item> <a href=../../techno/prometheus/ class=md-nav__link> <span class=md-ellipsis> Prometheus </span> </a> </li> <li class=md-nav__item> <a href=../../techno/rancherdesktop/ class=md-nav__link> <span class=md-ellipsis> Rancher Desktop </span> </a> </li> <li class=md-nav__item> <a href=../../techno/redis/ class=md-nav__link> <span class=md-ellipsis> Redis </span> </a> </li> <li class=md-nav__item> <a href=https://jbcodeforce.github.io/redpanda-studies/ class=md-nav__link> <span class=md-ellipsis> Red Panda </span> </a> </li> <li class=md-nav__item> <a href=../../techno/scaleway/ class=md-nav__link> <span class=md-ellipsis> Scaleway </span> </a> </li> <li class=md-nav__item> <a href=../../techno/solr/ class=md-nav__link> <span class=md-ellipsis> Solr </span> </a> </li> <li class=md-nav__item> <a href=https://jbcodeforce.github.io/spark-studies/ class=md-nav__link> <span class=md-ellipsis> Spark Studies </span> </a> </li> <li class=md-nav__item> <a href=../java-vscode/ class=md-nav__link> <span class=md-ellipsis> VScode </span> </a> </li> <li class=md-nav__item> <a href=../../techno/wsl2/ class=md-nav__link> <span class=md-ellipsis> WSL2-Ubuntu </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#value-propositions class=md-nav__link> <span class=md-ellipsis> Value Propositions </span> </a> </li> <li class=md-nav__item> <a href=#getting-started class=md-nav__link> <span class=md-ellipsis> Getting Started </span> </a> <nav class=md-nav aria-label="Getting Started"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#quarkus-cli class=md-nav__link> <span class=md-ellipsis> Quarkus CLI </span> </a> </li> <li class=md-nav__item> <a href=#create-a-project class=md-nav__link> <span class=md-ellipsis> Create a project </span> </a> </li> <li class=md-nav__item> <a href=#package-run class=md-nav__link> <span class=md-ellipsis> Package &amp; run </span> </a> </li> <li class=md-nav__item> <a href=#debug-within-vscode class=md-nav__link> <span class=md-ellipsis> Debug within VSCode </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#other-maven-quarkus-cli class=md-nav__link> <span class=md-ellipsis> Other Maven Quarkus CLI </span> </a> <nav class=md-nav aria-label="Other Maven Quarkus CLI"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#add-capabilities class=md-nav__link> <span class=md-ellipsis> Add capabilities </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#docker-build class=md-nav__link> <span class=md-ellipsis> Docker build </span> </a> </li> <li class=md-nav__item> <a href=#openapi class=md-nav__link> <span class=md-ellipsis> OpenAPI </span> </a> </li> <li class=md-nav__item> <a href=#running-on-openshift class=md-nav__link> <span class=md-ellipsis> Running on OpenShift </span> </a> <nav class=md-nav aria-label="Running on OpenShift"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#play-with-environment-variables class=md-nav__link> <span class=md-ellipsis> Play with environment variables </span> </a> </li> <li class=md-nav__item> <a href=#some-reusable-configuration class=md-nav__link> <span class=md-ellipsis> Some reusable configuration </span> </a> </li> <li class=md-nav__item> <a href=#remote-dev-mode class=md-nav__link> <span class=md-ellipsis> Remote dev mode </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#testing-with-quarkus class=md-nav__link> <span class=md-ellipsis> Testing with Quarkus </span> </a> <nav class=md-nav aria-label="Testing with Quarkus"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#maven-profile-and-quarkus-test class=md-nav__link> <span class=md-ellipsis> Maven profile and quarkus test </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#vue-app-with-quarkus-app class=md-nav__link> <span class=md-ellipsis> Vue app with quarkus app </span> </a> </li> <li class=md-nav__item> <a href=#reactive-crud-app-with-postgres class=md-nav__link> <span class=md-ellipsis> Reactive CRUD app with Postgres </span> </a> </li> <li class=md-nav__item> <a href=#command-mode-application class=md-nav__link> <span class=md-ellipsis> Command mode application </span> </a> </li> <li class=md-nav__item> <a href=#development-practices class=md-nav__link> <span class=md-ellipsis> Development practices </span> </a> <nav class=md-nav aria-label="Development practices"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#configuration class=md-nav__link> <span class=md-ellipsis> Configuration </span> </a> </li> <li class=md-nav__item> <a href=#get-access-to-start-and-stop-application-events class=md-nav__link> <span class=md-ellipsis> Get access to start and stop application events </span> </a> </li> <li class=md-nav__item> <a href=#testing-with-moquito class=md-nav__link> <span class=md-ellipsis> Testing with Moquito </span> </a> </li> <li class=md-nav__item> <a href=#reactive-with-mutiny class=md-nav__link> <span class=md-ellipsis> Reactive with Mutiny </span> </a> </li> <li class=md-nav__item> <a href=#reactive-messaging class=md-nav__link> <span class=md-ellipsis> Reactive messaging </span> </a> </li> <li class=md-nav__item> <a href=#a-case-for-kafka-to-sse class=md-nav__link> <span class=md-ellipsis> A case for Kafka to SSE </span> </a> </li> <li class=md-nav__item> <a href=#rest-client class=md-nav__link> <span class=md-ellipsis> REST Client </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#adopting-vertx class=md-nav__link> <span class=md-ellipsis> Adopting Vertx </span> </a> </li> <li class=md-nav__item> <a href=#typical-problems class=md-nav__link> <span class=md-ellipsis> Typical problems </span> </a> <nav class=md-nav aria-label="Typical problems"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#running-cloud-native class=md-nav__link> <span class=md-ellipsis> Running cloud native </span> </a> </li> <li class=md-nav__item> <a href=#run-quarkus-test-with-external-components-started-with-docker-compose class=md-nav__link> <span class=md-ellipsis> Run quarkus test with external components started with docker compose </span> </a> </li> <li class=md-nav__item> <a href=#cheat-sheet class=md-nav__link> <span class=md-ellipsis> Cheat-Sheet </span> </a> </li> <li class=md-nav__item> <a href=#to-read class=md-nav__link> <span class=md-ellipsis> To read </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=quarkus-summary-and-trick>Quarkus Summary and trick<a class=headerlink href=#quarkus-summary-and-trick title="Permanent link">&para;</a></h1> <p>Best source of knowledge is <a href=https://quarkus.io/guides/ >reading the guides</a> and the <a href=https://quarkus.io/quarkus-workshops/ >workshop</a>.</p> <div class="admonition info"> <p class=admonition-title>Info</p> <p>Updated 08/23/2023</p> </div> <h2 id=value-propositions>Value Propositions<a class=headerlink href=#value-propositions title="Permanent link">&para;</a></h2> <ul> <li>Designed to run java for microservice in container and OpenShift: reduce start time to microseconds, and reduce memory footprint.</li> <li>Run native in linux based image, so most of the java processing is done at build time.</li> <li>Extensible components, very easy to add dependencies and hide plumbing code</li> <li>Easy to develop integration tests at API level</li> <li>Quarkus implements reactive programming with Vert.x</li> <li> <blockquote> <p>50% reduction in resources demand</p> </blockquote> </li> <li>No need to retrain Java developer to nodejs</li> <li>Hot reload made developer flow faster: 20 microservices built per week.</li> </ul> <p>Quarkus HTTP support is based on a non-blocking and reactive engine (Eclipse Vert.x and Netty). All the HTTP requests your application receives, are handled by event loops (IO Thread) and then are routed towards the code that manages the request.</p> <h2 id=getting-started>Getting Started<a class=headerlink href=#getting-started title="Permanent link">&para;</a></h2> <h3 id=quarkus-cli>Quarkus CLI<a class=headerlink href=#quarkus-cli title="Permanent link">&para;</a></h3> <p><a href=https://quarkus.io/guides/cli-tooling>Quarkus CLI</a> lets you create projects, manage extensions and do essential build and dev commands using the underlying project’s build tool. It replaces the maven plugin. The CLI does not work on Java 1.8 so use <code>sdk</code> to change the SDK version.</p> <p>Always use <code>quarkus --help</code> and <code>quarkus --version</code> to get the last updated CLI.</p> <p>Here are some common commands:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=c1># Create a project with groupId=com.foo, artifactId=bar, and version=1.0.0-SNAPSHOT</span>
<a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a>quarkus<span class=w> </span>create<span class=w> </span>app<span class=w> </span>com.foo:bar
<a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a>
<a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=c1># List extension</span>
<a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a>quarkus<span class=w> </span>ext<span class=w> </span>ls
<a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a>
<a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a><span class=c1># Add extensions</span>
<a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a>quarkus<span class=w> </span>ext<span class=w> </span>add<span class=w> </span>openshift<span class=w> </span>qpid-jms<span class=w> </span>resteasy-reactive<span class=w> </span>smallrye-openapi<span class=w> </span>smallrye-health<span class=w> </span>quarkus-resteasy-reactive-jackson
<a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a><span class=c1># Build</span>
<a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a>quarkus<span class=w> </span>build
<a id=__codelineno-0-11 name=__codelineno-0-11 href=#__codelineno-0-11></a>
<a id=__codelineno-0-12 name=__codelineno-0-12 href=#__codelineno-0-12></a>quarkus<span class=w> </span>dev
</code></pre></div> <p>If the project could not be build because of missing maven wrapper use the following command:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a>mvn<span class=w> </span>-N<span class=w> </span>io.takari:maven:wrapper
</code></pre></div> <h3 id=create-a-project>Create a project<a class=headerlink href=#create-a-project title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=c1># new way with cli</span>
<a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a>quarkus<span class=w> </span>create<span class=w> </span>app<span class=w>  </span>-x<span class=w> </span>openapi,metrics,openshift,resteasy-reactive,resteasy-reactive-jackson<span class=w> </span>ibm.gtm.dba:app-name:1.0.0
<a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a><span class=c1># old way</span>
<a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a>mvn<span class=w> </span>io.quarkus:quarkus-maven-plugin:2.2.3.Final:create<span class=w> </span><span class=se>\</span>
<a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a><span class=w>    </span>-DprojectGroupId<span class=o>=</span>ibm.gse.eda<span class=w> </span><span class=se>\</span>
<a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a><span class=w>    </span>-DprojectArtifactId<span class=o>=</span>app-name<span class=w> </span><span class=se>\</span>
<a id=__codelineno-2-7 name=__codelineno-2-7 href=#__codelineno-2-7></a><span class=w>    </span>-Dpath<span class=o>=</span><span class=s2>&quot;/greeting&quot;</span>
<a id=__codelineno-2-8 name=__codelineno-2-8 href=#__codelineno-2-8></a><span class=nb>cd</span><span class=w> </span>app-name
</code></pre></div> <h3 id=package-run>Package &amp; run<a class=headerlink href=#package-run title="Permanent link">&para;</a></h3> <p>Run with automatic compilation </p> <div class=highlight><pre><span></span><code><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a>quarkus<span class=w> </span>dev
<a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a><span class=c1># build and  package</span>
<a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a>quarkus<span class=w> </span>build
<a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a><span class=c1># older way</span>
<a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a>./mvnw<span class=w> </span>compile<span class=w> </span>quarkus:dev
<a id=__codelineno-3-6 name=__codelineno-3-6 href=#__codelineno-3-6></a><span class=c1># packaging</span>
<a id=__codelineno-3-7 name=__codelineno-3-7 href=#__codelineno-3-7></a>./mvnw<span class=w> </span>clean<span class=w> </span>package
<a id=__codelineno-3-8 name=__codelineno-3-8 href=#__codelineno-3-8></a><span class=c1># or for native</span>
<a id=__codelineno-3-9 name=__codelineno-3-9 href=#__codelineno-3-9></a>./mvnw<span class=w> </span>clean<span class=w> </span>package<span class=w> </span>-Pnative
<a id=__codelineno-3-10 name=__codelineno-3-10 href=#__codelineno-3-10></a><span class=c1>#  build with a docker build image</span>
<a id=__codelineno-3-11 name=__codelineno-3-11 href=#__codelineno-3-11></a>./mvnw<span class=w> </span>package<span class=w> </span>-Pnative<span class=w> </span>-Dquarkus.native.container-build<span class=o>=</span><span class=nb>true</span><span class=w>  </span>-Dquarkus.container-image.build<span class=o>=</span><span class=nb>true</span>
</code></pre></div> <p>For native build see <a href=https://quarkus.io/guides/writing-native-applications-tips>QUARKUS - TIPS FOR WRITING NATIVE APPLICATIONS</a></p> <p>Start and override properties at runtime:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a>java<span class=w> </span>-Dquarkus.datasource.password<span class=o>=</span>youshallnotpass<span class=w> </span>-jar<span class=w> </span>target/myapp-runner.jar
</code></pre></div> <p>for a native executable: </p> <div class=highlight><pre><span></span><code><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a>./target/myapp-runner<span class=w> </span>-Dquarkus.datasource.password<span class=o>=</span>youshallnotpass
</code></pre></div> <p>See the <a href=https://quarkus.io/guides/building-native-image>Building a native executable</a> guide to develop with graalvm:</p> <ul> <li>Use <a href=https://developers.redhat.com/blog/2020/06/05/mandrel-a-community-distribution-of-graalvm-for-the-red-hat-build-of-quarkus/ >Mandrel</a> for java 11+ app, for linux OS</li> <li>Use Graalvm community edition for development JDK 1.8 Apps.</li> <li>Install native image with: <code>${GRAALVM_HOME}/bin/gu install native-image</code></li> <li>To generate debug symbols, add <code>-Dquarkus.native.debug.enabled=true</code> flag when generating the native executable.</li> <li>Run the tests against a native executable that has already been built: <code>./mvnw test-compile failsafe:integration-test</code> </li> <li>Build and deploy on OpenShift: add OpenShift plugin and do <a href=#running-on-openshift>these steps</a>.</li> </ul> <p>Can also use environment variables: Environment variables names are following the <a href=https://github.com/eclipse/microprofile-config/blob/master/spec/src/main/asciidoc/configsources.asciidoc#default-configsources>conversion rules of Eclipse MicroProfile</a>.</p> <h3 id=debug-within-vscode>Debug within VSCode<a class=headerlink href=#debug-within-vscode title="Permanent link">&para;</a></h3> <p>Start debugger: shift -&gt; cmd -&gt; P: <code>Quarkus: Debug current Quarkus Project</code> to create a configuration.</p> <h2 id=other-maven-quarkus-cli>Other Maven Quarkus CLI<a class=headerlink href=#other-maven-quarkus-cli title="Permanent link">&para;</a></h2> <p><a href=https://quarkus.io/guides/maven-tooling>See Maven tooling guide</a></p> <div class=highlight><pre><span></span><code><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=c1># Run integration tests on native app</span>
<a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a>./mvnw<span class=w> </span>verify<span class=w> </span>-Pnative
<a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a><span class=c1># Generate configuration for the application</span>
<a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a>./mvnw<span class=w> </span>quarkus:generate-config
</code></pre></div> <h3 id=add-capabilities>Add capabilities<a class=headerlink href=#add-capabilities title="Permanent link">&para;</a></h3> <p>Useful capabilities:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a>quarkus<span class=w> </span>ext<span class=w> </span>add<span class=w> </span>health,smallrye-openapi,kafka
</code></pre></div> <p>older way</p> <ul> <li><strong>Heath</strong> for liveness and readiness: <code>./mvnw quarkus:add-extension -Dextensions="smallrye-health"</code></li> <li><strong>Metrics</strong> for application monitoring: <code>./mvnw quarkus:add-extension -Dextensions="smallrye-metrics"</code></li> <li>Use API over HTTP in the JSON format: <code>./mvnw quarkus:add-extension -Dextensions="resteasy-jsonb"</code>.</li> <li><strong>Openapi</strong> and swagger-ui <code>./mvnw quarkus:add-extension -Dextensions="quarkus-smallrye-openapi"</code>. Also to get the swagger-ui visible in "production" set <code>quarkus.swagger-ui.always-include=true</code> in the application.properties.</li> <li><strong>Kafka</strong> client: <code>./mvnw quarkus:add-extension -Dextensions="kafka"</code></li> <li><strong>Kubernetes</strong> to get the deployment yaml file generated</li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a>./mvnw<span class=w> </span>quarkus:add-extension<span class=w> </span>-Dextensions<span class=o>=</span><span class=s2>&quot;kubernetes,kubernetes-config&quot;</span>
</code></pre></div> <ul> <li>Deploy to <strong>OpenShift</strong> using source to image <code>./mvnw quarkus:add-extension -Dextensions="openshift"</code>. See guide <a href=https://quarkus.io/guides/deploying-to-openshift>QUARKUS - DEPLOYING ON OPENSHIFT</a></li> <li><code>./mvnw quarkus:add-extension -Dextensions="container-image-docker"</code></li> <li> <p><strong>Postgres hibernate reactive</strong>: <code>./mvnw quarkus:add-extension -Dextensions=reactive-pg-client,resteasy-mutiny</code> Then see the <a href=https://quarkus.io/guides/reactive-sql-clients#reactive-postgresql-client-extension>REACTIVE SQL CLIENTS guide</a> and the <a href>maas_backend project</a></p> </li> <li> <p><strong>vert.x</strong>: <code>./mvnw quarkus:add-extension -Dextensions="vertx"</code></p> </li> <li><strong>jib</strong>: to do container image build. See <a href=https://quarkus.io/guides/container-image>note here</a> <code>./mvnw quarkus:add-extension -Dextensions="container-image-jib"</code></li> <li><strong><a href=https://kogito.kie.org>Kogito</a></strong>: <code>./mvnw quarkus:add-extension -Dextensions="kogito"</code></li> </ul> <h2 id=docker-build>Docker build<a class=headerlink href=#docker-build title="Permanent link">&para;</a></h2> <div class=highlight><pre><span></span><code><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=c1># image name will be the name of the project in pom. build only</span>
<a id=__codelineno-9-2 name=__codelineno-9-2 href=#__codelineno-9-2></a>./mvnw<span class=w> </span>clean<span class=w> </span>package<span class=w> </span>-Dnative<span class=w> </span>-Dquarkus.container-image.build<span class=o>=</span><span class=nb>true</span><span class=w> </span>-Dquarkus.container-image.group<span class=o>=</span>ibmcase<span class=w> </span>-Dquarkus.container-image.tag<span class=o>=</span><span class=m>1</span>.0.0
<a id=__codelineno-9-3 name=__codelineno-9-3 href=#__codelineno-9-3></a><span class=c1># and push it to repository: </span>
<a id=__codelineno-9-4 name=__codelineno-9-4 href=#__codelineno-9-4></a>./mvnw<span class=w> </span>clean<span class=w> </span>package<span class=w> </span>-Dquarkus.container-image.build<span class=o>=</span><span class=nb>true</span><span class=w> </span>-Dquarkus.container-image.push<span class=o>=</span><span class=nb>true</span>
</code></pre></div> <p>To avoid downloading all the maven jars while using a multistage Dockerfile and to keep the current executable started with <code>quarkus:dev</code> running on the same docker network as other dependent components, use a simple docker file for development that has java and maven:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a><span class=k>FROM</span><span class=w> </span><span class=s>maven:3.6.3-jdk-11</span>
<a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a>
<a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a><span class=k>COPY</span><span class=w> </span>pom.xml<span class=w> </span>/home/
<a id=__codelineno-10-4 name=__codelineno-10-4 href=#__codelineno-10-4></a><span class=k>COPY</span><span class=w> </span>src<span class=w> </span>/home/src/
<a id=__codelineno-10-5 name=__codelineno-10-5 href=#__codelineno-10-5></a>
<a id=__codelineno-10-6 name=__codelineno-10-6 href=#__codelineno-10-6></a><span class=k>WORKDIR</span><span class=w> </span><span class=s>/home</span>
<a id=__codelineno-10-7 name=__codelineno-10-7 href=#__codelineno-10-7></a>
<a id=__codelineno-10-8 name=__codelineno-10-8 href=#__codelineno-10-8></a><span class=k>CMD</span><span class=w> </span><span class=p>[</span><span class=s2>&quot;mvn&quot;</span><span class=p>,</span><span class=w> </span><span class=s2>&quot;compile&quot;</span><span class=p>,</span><span class=w> </span><span class=s2>&quot;quarkus:dev&quot;</span><span class=p>]</span>
</code></pre></div> <p>And then start it, by mounting the .m2 maven repository.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a>docker<span class=w> </span>build<span class=w> </span>-f<span class=w> </span>Dockerfile-dev<span class=w> </span>-t<span class=w> </span>tmp-builder<span class=w> </span>.
<a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a>docker<span class=w> </span>run<span class=w> </span>--rm<span class=w> </span>-p<span class=w> </span><span class=m>8080</span>:8080<span class=w> </span>-ti<span class=w>  </span>-v<span class=w> </span>~/.m2:/root/.m2<span class=w> </span>tmp-builder
</code></pre></div> <p>We can also combine this into a docker-compose <a href=https://github.com/ibm-cloud-architecture/refarch-eda-item-inventory/blob/master/dev-docker-compose.yaml>file like in the eda item inventory</a> project.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a><span class=w>  </span><span class=nt>maven</span><span class=p>:</span>
<a id=__codelineno-12-2 name=__codelineno-12-2 href=#__codelineno-12-2></a><span class=w>    </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">maven</span>
<a id=__codelineno-12-3 name=__codelineno-12-3 href=#__codelineno-12-3></a><span class=w>    </span><span class=nt>volumes</span><span class=p>:</span>
<a id=__codelineno-12-4 name=__codelineno-12-4 href=#__codelineno-12-4></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=s>&quot;./:/app&quot;</span>
<a id=__codelineno-12-5 name=__codelineno-12-5 href=#__codelineno-12-5></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=s>&quot;~/.m2:/root/.m2&quot;</span>
<a id=__codelineno-12-6 name=__codelineno-12-6 href=#__codelineno-12-6></a><span class=w>    </span><span class=nt>depends_on</span><span class=p>:</span>
<a id=__codelineno-12-7 name=__codelineno-12-7 href=#__codelineno-12-7></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">kafka</span>
<a id=__codelineno-12-8 name=__codelineno-12-8 href=#__codelineno-12-8></a><span class=w>    </span><span class=nt>hostname</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">aggregator</span>
<a id=__codelineno-12-9 name=__codelineno-12-9 href=#__codelineno-12-9></a><span class=w>    </span><span class=nt>environment</span><span class=p>:</span>
<a id=__codelineno-12-10 name=__codelineno-12-10 href=#__codelineno-12-10></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">BOOTSTRAP_SERVERS=kafka:9092</span>
<a id=__codelineno-12-11 name=__codelineno-12-11 href=#__codelineno-12-11></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">QUARKUS_KAFKA_STREAMS_BOOTSTRAP_SERVERS=kafka:29092</span>
<a id=__codelineno-12-12 name=__codelineno-12-12 href=#__codelineno-12-12></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">QUARKUS_PROFILE=dev</span>
<a id=__codelineno-12-13 name=__codelineno-12-13 href=#__codelineno-12-13></a><span class=w>    </span><span class=nt>ports</span><span class=p>:</span>
<a id=__codelineno-12-14 name=__codelineno-12-14 href=#__codelineno-12-14></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=s>&quot;8080:8080&quot;</span>
<a id=__codelineno-12-15 name=__codelineno-12-15 href=#__codelineno-12-15></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=s>&quot;5005:5005&quot;</span>
<a id=__codelineno-12-16 name=__codelineno-12-16 href=#__codelineno-12-16></a><span class=w>    </span><span class=nt>working_dir</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">/app</span>
<a id=__codelineno-12-17 name=__codelineno-12-17 href=#__codelineno-12-17></a><span class=w>    </span><span class=nt>command</span><span class=p>:</span><span class=w> </span><span class=s>&quot;mvn</span><span class=nv> </span><span class=s>quarkus:dev&quot;</span>
</code></pre></div> <h2 id=openapi>OpenAPI<a class=headerlink href=#openapi title="Permanent link">&para;</a></h2> <p>Add the declaration of the Application api in properties. <a href=https://quarkus.io/guides/openapi-swaggerui#configuration-reference>See this open API guide</a> for configuration details.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a><span class=na>%dev.mp.openapi.extensions.smallrye.info.title</span><span class=o>=</span><span class=s>Product Microservice API (development)</span>
<a id=__codelineno-13-2 name=__codelineno-13-2 href=#__codelineno-13-2></a><span class=na>mp.openapi.extensions.smallrye.info.title</span><span class=o>=</span><span class=s>Product Microservice API</span>
<a id=__codelineno-13-3 name=__codelineno-13-3 href=#__codelineno-13-3></a><span class=na>mp.openapi.extensions.smallrye.info.version</span><span class=o>=</span><span class=s>1.0.0</span>
<a id=__codelineno-13-4 name=__codelineno-13-4 href=#__codelineno-13-4></a><span class=na>mp.openapi.extensions.smallrye.info.description</span><span class=o>=</span><span class=s>Just an example of kafka consumer and service</span>
<a id=__codelineno-13-5 name=__codelineno-13-5 href=#__codelineno-13-5></a><span class=na>mp.openapi.extensions.smallrye.info.termsOfService</span><span class=o>=</span><span class=s>Demonstration purpose</span>
<a id=__codelineno-13-6 name=__codelineno-13-6 href=#__codelineno-13-6></a><span class=na>mp.openapi.extensions.smallrye.info.contact.name</span><span class=o>=</span><span class=s>IBM Technical Asset and Architecture team </span>
<a id=__codelineno-13-7 name=__codelineno-13-7 href=#__codelineno-13-7></a><span class=na>mp.openapi.extensions.smallrye.info.contact.url</span><span class=o>=</span><span class=s>https://ibm-cloud-architecture/refarch-eda</span>
<a id=__codelineno-13-8 name=__codelineno-13-8 href=#__codelineno-13-8></a><span class=na>mp.openapi.extensions.smallrye.info.license.name</span><span class=o>=</span><span class=s>Apache 2.0</span>
<a id=__codelineno-13-9 name=__codelineno-13-9 href=#__codelineno-13-9></a><span class=na>mp.openapi.extensions.smallrye.info.license.url</span><span class=o>=</span><span class=s>http://www.apache.org/licenses/LICENSE-2.0.html</span>
</code></pre></div> <h2 id=running-on-openshift>Running on OpenShift<a class=headerlink href=#running-on-openshift title="Permanent link">&para;</a></h2> <p>The guide is <a href=https://quarkus.io/guides/deploying-to-openshift>here</a> and the main points are:</p> <ul> <li>The OpenShift extension is actually a wrapper extension that brings together the kubernetes and container-image-s2i extensions with defaults so that it’s easier for the user to get started with Quarkus on OpenShift</li> <li>Build is done by source 2 image binary build: <code>./mvnw clean package -Dquarkus.container-image.build=true</code>. The output of the build is an ImageStream that is configured to automatically trigger a deployment</li> <li> <p>The first time, build and deployment are done with the command: <code>./mvnw clean package -Dquarkus.kubernetes.deploy=true</code>, after that, any build will trigger redeployment. Here are the steps done:</p> <ul> <li>Build thin jar</li> <li>Contact kubernetes API server</li> <li>Perform s2i binary build with jar on the server. This adds a BuildConfig on the connected project.</li> <li>Send source code from local folder to OpenShift build container.</li> <li>Write manifest and signatures </li> <li>Generate Dockerfile and build the image on server</li> <li>Push image to private registry</li> <li>Apply the manifests: service account, service, image stream, build config, and deployment config as defined by the generated <code>openshift.yaml</code></li> </ul> </li> <li> <p>Three pods are visible: build, deploy and running app.</p> </li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-14-1 name=__codelineno-14-1 href=#__codelineno-14-1></a><span class=c1># Remote build on OCP</span>
<a id=__codelineno-14-2 name=__codelineno-14-2 href=#__codelineno-14-2></a>mvn<span class=w> </span>clean<span class=w> </span>package<span class=w> </span>-Dquarkus.container-image.build<span class=o>=</span><span class=nb>true</span><span class=w> </span>-Dquarkus.kubernetes.deploy<span class=o>=</span><span class=nb>true</span><span class=w> </span>-DskipTests
<a id=__codelineno-14-3 name=__codelineno-14-3 href=#__codelineno-14-3></a><span class=c1># example from store simulator with UI</span>
<a id=__codelineno-14-4 name=__codelineno-14-4 href=#__codelineno-14-4></a>mvn<span class=w> </span>clean<span class=w> </span>package<span class=w> </span>-Dui.deps<span class=w> </span>-Dui.dev<span class=w> </span>-Dquarkus.container-image.build<span class=o>=</span><span class=nb>true</span><span class=w> </span>-Dquarkus.container-image.group<span class=o>=</span>ibmcase<span class=w> </span>-Dquarkus.container-image.tag<span class=o>=</span><span class=m>1</span>.0.0<span class=w> </span>-Dquarkus.kubernetes.deploy<span class=o>=</span><span class=nb>true</span><span class=w> </span>-DskipTests
<a id=__codelineno-14-5 name=__codelineno-14-5 href=#__codelineno-14-5></a><span class=c1># Get image streams</span>
<a id=__codelineno-14-6 name=__codelineno-14-6 href=#__codelineno-14-6></a>oc<span class=w> </span>get<span class=w> </span>is
<a id=__codelineno-14-7 name=__codelineno-14-7 href=#__codelineno-14-7></a><span class=c1># From the created image</span>
<a id=__codelineno-14-8 name=__codelineno-14-8 href=#__codelineno-14-8></a><span class=c1># Create an application in openshift- ex:</span>
<a id=__codelineno-14-9 name=__codelineno-14-9 href=#__codelineno-14-9></a>oc<span class=w> </span>new-app<span class=w> </span>--name<span class=o>=</span>credit-application-mgr<span class=w> </span>jb-credit-app/credit-application-mgr:1.0.0<span class=w> </span>
</code></pre></div> <p>See all <a href=https://quarkus.io/guides/deploying-to-openshift#configuration-reference>the configuration parameters here</a>.</p> <h3 id=play-with-environment-variables>Play with environment variables<a class=headerlink href=#play-with-environment-variables title="Permanent link">&para;</a></h3> <ul> <li> <p>To define environment variables, use config map:</p> <ul> <li>Add a config map with the variable name in the data filed as key. It follows the environment variable naming convention to overwrite quarkus' property. The config map can have multiple variables.</li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-15-1 name=__codelineno-15-1 href=#__codelineno-15-1></a><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<a id=__codelineno-15-2 name=__codelineno-15-2 href=#__codelineno-15-2></a><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">ConfigMap</span>
<a id=__codelineno-15-3 name=__codelineno-15-3 href=#__codelineno-15-3></a><span class=nt>metadata</span><span class=p>:</span>
<a id=__codelineno-15-4 name=__codelineno-15-4 href=#__codelineno-15-4></a><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">message-cm</span>
<a id=__codelineno-15-5 name=__codelineno-15-5 href=#__codelineno-15-5></a><span class=nt>data</span><span class=p>:</span>
<a id=__codelineno-15-6 name=__codelineno-15-6 href=#__codelineno-15-6></a><span class=w>  </span><span class=nt>GREETING_MESSAGE</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">salut</span>
</code></pre></div> <ul> <li>To inject environment variables from config map add a property with the name of the config map.</li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-16-1 name=__codelineno-16-1 href=#__codelineno-16-1></a><span class=na>greeting.message</span><span class=o>=</span><span class=s>bonjour</span>
<a id=__codelineno-16-2 name=__codelineno-16-2 href=#__codelineno-16-2></a><span class=na>quarkus.openshift.env.configmaps</span><span class=o>=</span><span class=s>message-cm</span>
</code></pre></div> </li> <li> <p>Redeploy: <code>./mvnw clean package -Dquarkus.kubernetes.deploy=true</code></p> </li> </ul> <p>This will add the following declaration to the deploymentConfig:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-17-1 name=__codelineno-17-1 href=#__codelineno-17-1></a><span class=w>      </span><span class=nt>envFrom</span><span class=p>:</span>
<a id=__codelineno-17-2 name=__codelineno-17-2 href=#__codelineno-17-2></a><span class=w>            </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>configMapRef</span><span class=p>:</span>
<a id=__codelineno-17-3 name=__codelineno-17-3 href=#__codelineno-17-3></a><span class=w>                </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">message-cm</span>
</code></pre></div> <ul> <li>To add config map, secrets, we need the <code>kubernetes-config</code> extension. <a href=https://quarkus.io/guides/kubernetes-config>See this guide</a>, then declare properties in the following formats:</li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-18-1 name=__codelineno-18-1 href=#__codelineno-18-1></a><span class=na>quarkus.openshift.env.configmaps</span><span class=o>=</span><span class=s>vaccine-order-ms-cm</span>
<a id=__codelineno-18-2 name=__codelineno-18-2 href=#__codelineno-18-2></a><span class=na>quarkus.openshift.env.secrets</span><span class=o>=</span><span class=s>vaccine-order-secrets</span>
<a id=__codelineno-18-3 name=__codelineno-18-3 href=#__codelineno-18-3></a><span class=na>quarkus.openshift.env.mapping.KAFKA_SSL_TRUSTSTORE_PASSWORD.from-secret</span><span class=o>=</span><span class=s>light-es-cluster-ca-cert</span>
<a id=__codelineno-18-4 name=__codelineno-18-4 href=#__codelineno-18-4></a><span class=na>quarkus.openshift.env.mapping.KAFKA_SSL_TRUSTSTORE_PASSWORD.with-key</span><span class=o>=</span><span class=s>ca.password</span>
<a id=__codelineno-18-5 name=__codelineno-18-5 href=#__codelineno-18-5></a><span class=na>quarkus.openshift.mounts.es-cert.path</span><span class=o>=</span><span class=s>/deployments/certs/server</span>
<a id=__codelineno-18-6 name=__codelineno-18-6 href=#__codelineno-18-6></a><span class=na>quarkus.openshift.secret-volumes.es-cert.secret-name</span><span class=o>=</span><span class=s>light-es-cluster-ca-cert</span>
</code></pre></div> <p>That will generate the following spec:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-19-1 name=__codelineno-19-1 href=#__codelineno-19-1></a><span class=w>   </span><span class=nt>envFrom</span><span class=p>:</span>
<a id=__codelineno-19-2 name=__codelineno-19-2 href=#__codelineno-19-2></a><span class=w>     </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>configMapRef</span><span class=p>:</span>
<a id=__codelineno-19-3 name=__codelineno-19-3 href=#__codelineno-19-3></a><span class=w>       </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">vaccine-order-ms-cm</span>
<a id=__codelineno-19-4 name=__codelineno-19-4 href=#__codelineno-19-4></a><span class=w>     </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>secretRef</span><span class=p>:</span>
<a id=__codelineno-19-5 name=__codelineno-19-5 href=#__codelineno-19-5></a><span class=w>       </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">vaccine-order-secrets</span>
<a id=__codelineno-19-6 name=__codelineno-19-6 href=#__codelineno-19-6></a><span class=w>   </span><span class=nt>volumeMounts</span><span class=p>:</span>
<a id=__codelineno-19-7 name=__codelineno-19-7 href=#__codelineno-19-7></a><span class=w>   </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>mountPath</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">/deployments/certs/server</span>
<a id=__codelineno-19-8 name=__codelineno-19-8 href=#__codelineno-19-8></a><span class=w>     </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">es-cert</span>
<a id=__codelineno-19-9 name=__codelineno-19-9 href=#__codelineno-19-9></a><span class=w>     </span><span class=nt>readOnly</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<a id=__codelineno-19-10 name=__codelineno-19-10 href=#__codelineno-19-10></a><span class=w>     </span><span class=nt>subPath</span><span class=p>:</span><span class=w> </span><span class=s>&quot;&quot;</span>
<a id=__codelineno-19-11 name=__codelineno-19-11 href=#__codelineno-19-11></a><span class="w w-Error"> </span><span class=nt>volumes</span><span class=p>:</span>
<a id=__codelineno-19-12 name=__codelineno-19-12 href=#__codelineno-19-12></a><span class=w>     </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">es-cert</span>
<a id=__codelineno-19-13 name=__codelineno-19-13 href=#__codelineno-19-13></a><span class=w>       </span><span class=nt>secret</span><span class=p>:</span>
<a id=__codelineno-19-14 name=__codelineno-19-14 href=#__codelineno-19-14></a><span class=w>         </span><span class=nt>defaultMode</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">384</span>
<a id=__codelineno-19-15 name=__codelineno-19-15 href=#__codelineno-19-15></a><span class=w>         </span><span class=nt>optional</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<a id=__codelineno-19-16 name=__codelineno-19-16 href=#__codelineno-19-16></a><span class=w>         </span><span class=nt>secretName</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">sandbox-rp-cluster-ca-cert</span>
</code></pre></div> <p>See <a href=https://quarkus.io/guides/deploying-to-kubernetes#openshift>OpenShift options</a></p> <p>To change the value of a specific property in the application properties, we can use environment variables: The convention is to convert the name of the property to uppercase and replace every dot (.) with an underscore (_). So define a config map to define those environment variables in <code>src/main/kubernetes</code> folder.</p> <h3 id=some-reusable-configuration>Some reusable configuration<a class=headerlink href=#some-reusable-configuration title="Permanent link">&para;</a></h3> <ul> <li>To expose a route add:</li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-20-1 name=__codelineno-20-1 href=#__codelineno-20-1></a><span class=na>quarkus.openshift.expose.route</span><span class=o>=</span><span class=s>true</span>
</code></pre></div> <ul> <li>Set logging level</li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-21-1 name=__codelineno-21-1 href=#__codelineno-21-1></a><span class=na>quarkus.log.console.enable</span><span class=o>=</span><span class=s>true</span>
<a id=__codelineno-21-2 name=__codelineno-21-2 href=#__codelineno-21-2></a><span class=na>quarkus.log.console.format</span><span class=o>=</span><span class=s>%d{HH:mm:ss} %-5p [%c{2.}] (%t) %s%e%n</span>
<a id=__codelineno-21-3 name=__codelineno-21-3 href=#__codelineno-21-3></a><span class=na>quarkus.log.console.level</span><span class=o>=</span><span class=s>DEBUG</span>
<a id=__codelineno-21-4 name=__codelineno-21-4 href=#__codelineno-21-4></a><span class=na>quarkus.log.console.color</span><span class=o>=</span><span class=s>true</span>
</code></pre></div> <h3 id=remote-dev-mode>Remote dev mode<a class=headerlink href=#remote-dev-mode title="Permanent link">&para;</a></h3> <p>For running Quarkus app on OpenShift while developing locally so change done on code, pom.xml, properties are sent to the remote quarkus use the following settings:</p> <p>See <a href=https://quarkus.io/guides/maven-tooling#remote-development-mode>this guide section</a>.</p> <ul> <li>Add in application.properties:</li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-22-1 name=__codelineno-22-1 href=#__codelineno-22-1></a><span class=na>quarkus.package.type</span><span class=o>=</span><span class=s>mutable-jar</span>
<a id=__codelineno-22-2 name=__codelineno-22-2 href=#__codelineno-22-2></a><span class=na>quarkus.live-reload.password</span><span class=o>=</span><span class=s>changeit</span>
</code></pre></div> <ul> <li>set the environment variable QUARKUS_LAUNCH_DEVMODE=true</li> <li>start with <code>./mvnw quarkus:remote-dev -Dquarkus.live-reload.url=http://my-remote-host:8080</code></li> </ul> <p>This is done via a HTTP based long polling transport, that will synchronize your local workspace and the remote application via HTTP calls.</p> <h2 id=testing-with-quarkus>Testing with Quarkus<a class=headerlink href=#testing-with-quarkus title="Permanent link">&para;</a></h2> <p>Quarkus uses junit 5, and QuarkusTest to access to CDI and other Quarkus goodies. <code>quarkus dev</code> enables continuous testing, and understands what tests are affected by code changes.</p> <p>See <a href=https://quarkus.io/guides/getting-started-testing>the test guide here</a>. </p> <p>With the dev console (<code>/q/dev</code>) offers access to the test UI. To test via HTTP, and rest-assured. </p> <p>Here is an example for post testing:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-23-1 name=__codelineno-23-1 href=#__codelineno-23-1></a><span class=n>TrainSearchRequest</span><span class=w> </span><span class=n>req</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>TrainSearchRequest</span><span class=p>();</span><span class=w> </span><span class=c1>//...</span>
<a id=__codelineno-23-2 name=__codelineno-23-2 href=#__codelineno-23-2></a><span class=n>Response</span><span class=w> </span><span class=n>resp</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>with</span><span class=p>().</span><span class=na>headers</span><span class=p>(</span><span class=s>&quot;Content-Type&quot;</span><span class=p>,</span><span class=w> </span><span class=n>ContentType</span><span class=p>.</span><span class=na>JSON</span><span class=p>,</span><span class=w> </span><span class=s>&quot;Accept&quot;</span><span class=p>,</span><span class=w> </span><span class=n>ContentType</span><span class=p>.</span><span class=na>JSON</span><span class=p>)</span>
<a id=__codelineno-23-3 name=__codelineno-23-3 href=#__codelineno-23-3></a><span class=w>          </span><span class=p>.</span><span class=na>body</span><span class=p>(</span><span class=n>req</span><span class=p>)</span>
<a id=__codelineno-23-4 name=__codelineno-23-4 href=#__codelineno-23-4></a><span class=w>          </span><span class=p>.</span><span class=na>when</span><span class=p>().</span><span class=na>post</span><span class=p>(</span><span class=s>&quot;/consolidatorA&quot;</span><span class=p>)</span>
<a id=__codelineno-23-5 name=__codelineno-23-5 href=#__codelineno-23-5></a><span class=w>          </span><span class=p>.</span><span class=na>then</span><span class=p>()</span>
<a id=__codelineno-23-6 name=__codelineno-23-6 href=#__codelineno-23-6></a><span class=w>             </span><span class=p>.</span><span class=na>statusCode</span><span class=p>(</span><span class=mi>200</span><span class=p>)</span>
<a id=__codelineno-23-7 name=__codelineno-23-7 href=#__codelineno-23-7></a><span class=w>             </span><span class=p>.</span><span class=na>contentType</span><span class=p>(</span><span class=n>ContentType</span><span class=p>.</span><span class=na>JSON</span><span class=p>)</span>
<a id=__codelineno-23-8 name=__codelineno-23-8 href=#__codelineno-23-8></a><span class=w>        </span><span class=p>.</span><span class=na>extract</span><span class=p>()</span>
<a id=__codelineno-23-9 name=__codelineno-23-9 href=#__codelineno-23-9></a><span class=w>        </span><span class=p>.</span><span class=na>response</span><span class=p>();</span>
<a id=__codelineno-23-10 name=__codelineno-23-10 href=#__codelineno-23-10></a><span class=w>        </span><span class=n>TrainSearchResponse</span><span class=w> </span><span class=n>searchResp</span><span class=o>=</span><span class=w> </span><span class=n>resp</span><span class=p>.</span><span class=na>body</span><span class=p>().</span><span class=na>as</span><span class=p>(</span><span class=n>TrainSearchResponse</span><span class=p>.</span><span class=na>class</span><span class=p>);</span>
</code></pre></div> <p>Other example on a Get</p> <div class=highlight><pre><span></span><code><a id=__codelineno-24-1 name=__codelineno-24-1 href=#__codelineno-24-1></a><span class=n>Response</span><span class=w> </span><span class=n>rep</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>given</span><span class=p>()</span>
<a id=__codelineno-24-2 name=__codelineno-24-2 href=#__codelineno-24-2></a><span class=w>          </span><span class=p>.</span><span class=na>when</span><span class=p>().</span><span class=na>get</span><span class=p>(</span><span class=n>basicURL</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=s>&quot;/names&quot;</span><span class=p>)</span>
<a id=__codelineno-24-3 name=__codelineno-24-3 href=#__codelineno-24-3></a><span class=w>          </span><span class=p>.</span><span class=na>then</span><span class=p>()</span>
<a id=__codelineno-24-4 name=__codelineno-24-4 href=#__codelineno-24-4></a><span class=w>             </span><span class=p>.</span><span class=na>statusCode</span><span class=p>(</span><span class=mi>200</span><span class=p>)</span>
<a id=__codelineno-24-5 name=__codelineno-24-5 href=#__codelineno-24-5></a><span class=w>             </span><span class=p>.</span><span class=na>contentType</span><span class=p>(</span><span class=n>ContentType</span><span class=p>.</span><span class=na>JSON</span><span class=p>)</span>
<a id=__codelineno-24-6 name=__codelineno-24-6 href=#__codelineno-24-6></a><span class=w>        </span><span class=p>.</span><span class=na>extract</span><span class=p>()</span>
<a id=__codelineno-24-7 name=__codelineno-24-7 href=#__codelineno-24-7></a><span class=w>        </span><span class=p>.</span><span class=na>response</span><span class=p>();</span>
<a id=__codelineno-24-8 name=__codelineno-24-8 href=#__codelineno-24-8></a><span class=w>        </span><span class=n>String</span><span class=o>[]</span><span class=w> </span><span class=n>names</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>rep</span><span class=p>.</span><span class=na>body</span><span class=p>().</span><span class=na>as</span><span class=p>(</span><span class=n>String</span><span class=o>[]</span><span class=p>.</span><span class=na>class</span><span class=p>);</span>
<a id=__codelineno-24-9 name=__codelineno-24-9 href=#__codelineno-24-9></a><span class=w>        </span><span class=n>Assertions</span><span class=p>.</span><span class=na>assertNotNull</span><span class=p>(</span><span class=n>names</span><span class=p>);</span>
<a id=__codelineno-24-10 name=__codelineno-24-10 href=#__codelineno-24-10></a><span class=w>        </span><span class=n>Assertions</span><span class=p>.</span><span class=na>assertEquals</span><span class=p>(</span><span class=mi>3</span><span class=p>,</span><span class=n>names</span><span class=p>.</span><span class=na>length</span><span class=p>);</span>
</code></pre></div> <p>Application configuration will be used in any active profile. The built-in profiles in Quarkus are: <code>dev, prod and test</code>. The <code>test</code> profile will be used every time you run the <code>@QuarkusTest</code>.</p> <p><code>@QuarkusTest</code> helps to get the CDI working. But there is still an issue on inject properties that may not be loaded due to proxy instance creation. So in test class the properties need to be accessed via getter: For example to be sure the hostname is loaded from the <code>application.properties</code> do:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-25-1 name=__codelineno-25-1 href=#__codelineno-25-1></a><span class=nd>@ApplicationScoped</span>
<a id=__codelineno-25-2 name=__codelineno-25-2 href=#__codelineno-25-2></a><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>RabbitMQItemGenerator</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-25-3 name=__codelineno-25-3 href=#__codelineno-25-3></a>
<a id=__codelineno-25-4 name=__codelineno-25-4 href=#__codelineno-25-4></a><span class=w>  </span><span class=nd>@ConfigProperty</span><span class=p>(</span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;amqp.host&quot;</span><span class=p>)</span>
<a id=__codelineno-25-5 name=__codelineno-25-5 href=#__codelineno-25-5></a><span class=w>  </span><span class=kd>public</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>hostname</span><span class=p>;</span>
<a id=__codelineno-25-6 name=__codelineno-25-6 href=#__codelineno-25-6></a><span class=p>...</span>
<a id=__codelineno-25-7 name=__codelineno-25-7 href=#__codelineno-25-7></a>
<a id=__codelineno-25-8 name=__codelineno-25-8 href=#__codelineno-25-8></a><span class=nd>@QuarkusTest</span>
<a id=__codelineno-25-9 name=__codelineno-25-9 href=#__codelineno-25-9></a><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>TestRabbitGenerator</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-25-10 name=__codelineno-25-10 href=#__codelineno-25-10></a>
<a id=__codelineno-25-11 name=__codelineno-25-11 href=#__codelineno-25-11></a><span class=w>    </span><span class=nd>@Inject</span>
<a id=__codelineno-25-12 name=__codelineno-25-12 href=#__codelineno-25-12></a><span class=w>    </span><span class=n>RabbitMQItemGenerator</span><span class=w> </span><span class=n>generator</span><span class=p>;</span>
<a id=__codelineno-25-13 name=__codelineno-25-13 href=#__codelineno-25-13></a>
<a id=__codelineno-25-14 name=__codelineno-25-14 href=#__codelineno-25-14></a><span class=w>    </span><span class=p>...</span>
<a id=__codelineno-25-15 name=__codelineno-25-15 href=#__codelineno-25-15></a><span class=w>    </span><span class=n>Assertions</span><span class=p>.</span><span class=na>assertNotNull</span><span class=p>(</span><span class=n>generator</span><span class=p>.</span><span class=na>getHost</span><span class=p>());</span>
</code></pre></div> <p>Things to do:</p> <ul> <li>in the test class add @QuarkusTest</li> <li>inject the bean under test</li> <li>be sure to use the good version of maven-surefire</li> <li>set the java.util.logging system property to make sure tests will use the correct log manager:</li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-26-1 name=__codelineno-26-1 href=#__codelineno-26-1></a><span class=nt>&lt;systemPropertyVariables&gt;</span>
<a id=__codelineno-26-2 name=__codelineno-26-2 href=#__codelineno-26-2></a><span class=w>    </span><span class=nt>&lt;java.util.logging.manager&gt;</span>org.jboss.logmanager.LogManager<span class=nt>&lt;/java.util.logging.manager&gt;</span>
<a id=__codelineno-26-3 name=__codelineno-26-3 href=#__codelineno-26-3></a><span class=nt>&lt;/systemPropertyVariables&gt;</span>
</code></pre></div> <ul> <li>Exposed port for tests are on port 8081 (can be changed via <code>quarkus.http.test-port=8083</code>)</li> </ul> <p>Integration test uses <a href=http://rest-assured.io/ >Rest-assured</a> with <a href=https://github.com/rest-assured/rest-assured/wiki/Usage>API doc</a>.</p> <p>For testing body content, use the <a href=http://hamcrest.org/JavaHamcrest/javadoc/1.3/org/hamcrest/CoreMatchers.html>Hamcrest APIs</a>. Example of not and containsString operators.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-27-1 name=__codelineno-27-1 href=#__codelineno-27-1></a><span class=kd>public</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>shouldNotHaveStore_7_fromGetStoreNames</span><span class=p>(){</span>
<a id=__codelineno-27-2 name=__codelineno-27-2 href=#__codelineno-27-2></a><span class=w>        </span><span class=n>given</span><span class=p>().</span><span class=na>when</span><span class=p>().</span><span class=na>get</span><span class=p>(</span><span class=s>&quot;/names&quot;</span><span class=p>).</span><span class=na>then</span><span class=p>().</span><span class=na>statusCode</span><span class=p>(</span><span class=mi>200</span><span class=p>).</span><span class=na>body</span><span class=p>(</span><span class=n>not</span><span class=p>(</span><span class=n>containsString</span><span class=p>(</span><span class=s>&quot;Store_7&quot;</span><span class=p>)));</span>
<a id=__codelineno-27-3 name=__codelineno-27-3 href=#__codelineno-27-3></a><span class=w>    </span><span class=p>}</span>
</code></pre></div> <h3 id=maven-profile-and-quarkus-test>Maven profile and quarkus test<a class=headerlink href=#maven-profile-and-quarkus-test title="Permanent link">&para;</a></h3> <p>The properties can be prefixed with <code>%staging</code> or <code>%prod</code> or <code>%dev</code> to set those properties according to the deployment. If we use a custom prefix like <code>staging</code> then we need to run quarkus with a specific profile. For that set <code>export QUARKUS_PROFILE=staging</code> in your <code>.env</code> file. </p> <p>By default, Quarkus tests in JVM mode are run using the test configuration profile</p> <h2 id=vue-app-with-quarkus-app>Vue app with quarkus app<a class=headerlink href=#vue-app-with-quarkus-app title="Permanent link">&para;</a></h2> <p>See <a href=https://jbcodeforce.github.io/vuejs-studies/#vue-app-with-quarkus-app>this separate note</a>.</p> <h2 id=reactive-crud-app-with-postgres>Reactive CRUD app with Postgres<a class=headerlink href=#reactive-crud-app-with-postgres title="Permanent link">&para;</a></h2> <ul> <li>Add following to pom.xml</li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-28-1 name=__codelineno-28-1 href=#__codelineno-28-1></a><span class=nt>&lt;dependency&gt;</span>
<a id=__codelineno-28-2 name=__codelineno-28-2 href=#__codelineno-28-2></a><span class=w>      </span><span class=nt>&lt;groupId&gt;</span>io.quarkus<span class=nt>&lt;/groupId&gt;</span>
<a id=__codelineno-28-3 name=__codelineno-28-3 href=#__codelineno-28-3></a><span class=w>      </span><span class=nt>&lt;artifactId&gt;</span>quarkus-resteasy-mutiny<span class=nt>&lt;/artifactId&gt;</span>
<a id=__codelineno-28-4 name=__codelineno-28-4 href=#__codelineno-28-4></a><span class=w>    </span><span class=nt>&lt;/dependency&gt;</span>
<a id=__codelineno-28-5 name=__codelineno-28-5 href=#__codelineno-28-5></a><span class=w>    </span><span class=nt>&lt;dependency&gt;</span>
<a id=__codelineno-28-6 name=__codelineno-28-6 href=#__codelineno-28-6></a><span class=w>      </span><span class=nt>&lt;groupId&gt;</span>io.quarkus<span class=nt>&lt;/groupId&gt;</span>
<a id=__codelineno-28-7 name=__codelineno-28-7 href=#__codelineno-28-7></a><span class=w>      </span><span class=nt>&lt;artifactId&gt;</span>quarkus-reactive-pg-client<span class=nt>&lt;/artifactId&gt;</span>
<a id=__codelineno-28-8 name=__codelineno-28-8 href=#__codelineno-28-8></a><span class=w>    </span><span class=nt>&lt;/dependency&gt;</span>
<a id=__codelineno-28-9 name=__codelineno-28-9 href=#__codelineno-28-9></a><span class=w>    </span><span class=nt>&lt;dependency&gt;</span>
<a id=__codelineno-28-10 name=__codelineno-28-10 href=#__codelineno-28-10></a><span class=w>      </span><span class=nt>&lt;groupId&gt;</span>io.quarkus<span class=nt>&lt;/groupId&gt;</span>
<a id=__codelineno-28-11 name=__codelineno-28-11 href=#__codelineno-28-11></a><span class=w>      </span><span class=nt>&lt;artifactId&gt;</span>quarkus-hibernate-reactive<span class=nt>&lt;/artifactId&gt;</span>
<a id=__codelineno-28-12 name=__codelineno-28-12 href=#__codelineno-28-12></a><span class=w>  </span><span class=nt>&lt;/dependency&gt;</span>
</code></pre></div> <ul> <li>Annotate the entity with table and query</li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-29-1 name=__codelineno-29-1 href=#__codelineno-29-1></a><span class=nd>@Entity</span>
<a id=__codelineno-29-2 name=__codelineno-29-2 href=#__codelineno-29-2></a><span class=nd>@Table</span><span class=p>(</span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;kafka_clusters&quot;</span><span class=p>)</span>
<a id=__codelineno-29-3 name=__codelineno-29-3 href=#__codelineno-29-3></a><span class=nd>@NamedQuery</span><span class=p>(</span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;ClusterDetail.findAll&quot;</span><span class=p>,</span><span class=w> </span><span class=n>query</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;SELECT k FROM kafka_clusters k ORDER BY k.name&quot;</span><span class=p>)</span>
<a id=__codelineno-29-4 name=__codelineno-29-4 href=#__codelineno-29-4></a><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>ClusterDetail</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-29-5 name=__codelineno-29-5 href=#__codelineno-29-5></a>
<a id=__codelineno-29-6 name=__codelineno-29-6 href=#__codelineno-29-6></a><span class=w>    </span><span class=nd>@Id</span>
<a id=__codelineno-29-7 name=__codelineno-29-7 href=#__codelineno-29-7></a><span class=w>    </span><span class=nd>@SequenceGenerator</span><span class=p>(</span><span class=n>name</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;fruitsSequence&quot;</span><span class=p>,</span><span class=w> </span><span class=n>sequenceName</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;known_fruits_id_seq&quot;</span><span class=p>,</span><span class=w> </span><span class=n>allocationSize</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>1</span><span class=p>,</span><span class=w> </span><span class=n>initialValue</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=mi>10</span><span class=p>)</span>
<a id=__codelineno-29-8 name=__codelineno-29-8 href=#__codelineno-29-8></a><span class=w>    </span><span class=nd>@GeneratedValue</span><span class=p>(</span><span class=n>generator</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s>&quot;fruitsSequence&quot;</span><span class=p>)</span>
<a id=__codelineno-29-9 name=__codelineno-29-9 href=#__codelineno-29-9></a><span class=w>    </span><span class=kd>private</span><span class=w> </span><span class=n>Integer</span><span class=w> </span><span class=n>id</span><span class=p>;</span>
</code></pre></div> <h2 id=command-mode-application>Command mode application<a class=headerlink href=#command-mode-application title="Permanent link">&para;</a></h2> <p>Develop <a href=https://quarkus.io/guides/command-mode-reference>command mode applications</a> that run and then exit, like a java main method.</p> <p>For that implement QuarkusApplication and have Quarkus run this method automatically</p> <div class=highlight><pre><span></span><code><a id=__codelineno-30-1 name=__codelineno-30-1 href=#__codelineno-30-1></a><span class=nd>@QuarkusMain</span>
<a id=__codelineno-30-2 name=__codelineno-30-2 href=#__codelineno-30-2></a><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>CommandModeApp</span><span class=w> </span><span class=kd>implements</span><span class=w> </span><span class=n>QuarkusApplication</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-30-3 name=__codelineno-30-3 href=#__codelineno-30-3></a>
<a id=__codelineno-30-4 name=__codelineno-30-4 href=#__codelineno-30-4></a><span class=w>    </span><span class=nd>@Override</span>
<a id=__codelineno-30-5 name=__codelineno-30-5 href=#__codelineno-30-5></a><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>int</span><span class=w> </span><span class=nf>run</span><span class=p>(</span><span class=n>String</span><span class=p>...</span><span class=w> </span><span class=n>args</span><span class=p>)</span><span class=w> </span><span class=kd>throws</span><span class=w> </span><span class=n>Exception</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-30-6 name=__codelineno-30-6 href=#__codelineno-30-6></a><span class=w>        </span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;Hello from mars&quot;</span><span class=p>);</span>
<a id=__codelineno-30-7 name=__codelineno-30-7 href=#__codelineno-30-7></a><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=mi>10</span><span class=p>;</span>
<a id=__codelineno-30-8 name=__codelineno-30-8 href=#__codelineno-30-8></a><span class=w>    </span><span class=p>}</span>
</code></pre></div> <p>A @QuarkusMain instance is an application scoped bean by default.</p> <p>For a Java main app</p> <div class=highlight><pre><span></span><code><a id=__codelineno-31-1 name=__codelineno-31-1 href=#__codelineno-31-1></a><span class=nd>@QuarkusMain</span><span class=p>(</span><span class=n>name</span><span class=p>:</span><span class=w> </span><span class=s>&quot;kbMain&quot;</span><span class=p>)</span>
<a id=__codelineno-31-2 name=__codelineno-31-2 href=#__codelineno-31-2></a><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>JavaMain</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-31-3 name=__codelineno-31-3 href=#__codelineno-31-3></a>
<a id=__codelineno-31-4 name=__codelineno-31-4 href=#__codelineno-31-4></a><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kd>static</span><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>main</span><span class=p>(</span><span class=n>String</span><span class=p>...</span><span class=w> </span><span class=n>args</span><span class=p>)</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-31-5 name=__codelineno-31-5 href=#__codelineno-31-5></a><span class=w>        </span><span class=n>Quarkus</span><span class=p>.</span><span class=na>run</span><span class=p>(</span><span class=n>HelloWorldMain</span><span class=p>.</span><span class=na>class</span><span class=p>,</span><span class=w> </span><span class=n>args</span><span class=p>);</span>
<a id=__codelineno-31-6 name=__codelineno-31-6 href=#__codelineno-31-6></a><span class=w>    </span><span class=p>}</span>
<a id=__codelineno-31-7 name=__codelineno-31-7 href=#__codelineno-31-7></a><span class=p>}</span>
</code></pre></div> <p>Dev mode works the same.</p> <p>Then <code>mvn package</code> and run it with <code>java -jar target/....-runner.jar</code></p> <p>When running a command mode application the basic lifecycle is as follows:</p> <ul> <li>Start Quarkus</li> <li>Run the QuarkusApplication main method</li> <li>Shut down Quarkus and exit the JVM after the main method returns</li> </ul> <p>It is possible to have multiple main methods in an application, and select between them at build time. The @QuarkusMain annotation takes an optional 'name' parameter and the name is used with <code>-Dquarkus.package.main-class="kbMain"</code>. If the app needs arguments, pass them with <code>-Dquarkus.args=</code>.</p> <h2 id=development-practices>Development practices<a class=headerlink href=#development-practices title="Permanent link">&para;</a></h2> <h3 id=configuration>Configuration<a class=headerlink href=#configuration title="Permanent link">&para;</a></h3> <p><code>application.properties</code> content is injected with code like:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-32-1 name=__codelineno-32-1 href=#__codelineno-32-1></a><span class=w>    </span><span class=nd>@ConfigProperty</span><span class=p>(</span><span class=n>name</span><span class=o>=</span><span class=s>&quot;temperature.threshold&quot;</span><span class=p>,</span><span class=w> </span><span class=n>defaultValue</span><span class=o>=</span><span class=s>&quot;2.5&quot;</span><span class=p>)</span>
<a id=__codelineno-32-2 name=__codelineno-32-2 href=#__codelineno-32-2></a><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=kt>double</span><span class=w> </span><span class=n>temperatureThreshold</span><span class=p>;</span>
</code></pre></div> <p>Quarkus does much of its configuration and bootstrap at build time. But some properties are defined at run time from system properties, environment variables (in uppercase, . transformed as _ : QUARKUS_DATASOURCE_PASSWORD), using <code>.env</code> file, and then <code>application.property</code> in a <code>$(pwd)/target/config</code> folder for development test.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-33-1 name=__codelineno-33-1 href=#__codelineno-33-1></a><span class=c1>// does fail as it return -</span>
<a id=__codelineno-33-2 name=__codelineno-33-2 href=#__codelineno-33-2></a><span class=n>Assertions</span><span class=p>.</span><span class=na>assertEquals</span><span class=p>(</span><span class=mf>2.0</span><span class=p>,</span><span class=w> </span><span class=n>assessor</span><span class=p>.</span><span class=na>temperatureThreshold</span><span class=p>);</span>
<a id=__codelineno-33-3 name=__codelineno-33-3 href=#__codelineno-33-3></a><span class=c1>// while this works!</span>
<a id=__codelineno-33-4 name=__codelineno-33-4 href=#__codelineno-33-4></a><span class=n>Assertions</span><span class=p>.</span><span class=na>assertEquals</span><span class=p>(</span><span class=mf>2.0</span><span class=p>,</span><span class=w> </span><span class=n>assessor</span><span class=p>.</span><span class=na>getTemperatureThreshold</span><span class=p>());</span>
</code></pre></div> <p>The content can be combined with environment variables See <a href=https://quarkus.io/guides/config#combining-property-expressions-and-environment-variables>this section in quarkus guide</a></p> <p>Also you can access the configuration programmatically. It can be handy to achieve dynamic lookup, or retrieve configured values from classes that are neither CDI beans or JAX-RS resources. See <a href=https://quarkus.io/guides/config#programmatically-access-the-configuration>this paragraph</a></p> <div class=highlight><pre><span></span><code><a id=__codelineno-34-1 name=__codelineno-34-1 href=#__codelineno-34-1></a><span class=n>String</span><span class=w> </span><span class=n>databaseName</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ConfigProvider</span><span class=p>.</span><span class=na>getConfig</span><span class=p>().</span><span class=na>getValue</span><span class=p>(</span><span class=s>&quot;database.name&quot;</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=p>.</span><span class=na>class</span><span class=p>);</span>
<a id=__codelineno-34-2 name=__codelineno-34-2 href=#__codelineno-34-2></a><span class=n>Optional</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span><span class=w> </span><span class=n>maybeDatabaseName</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>ConfigProvider</span><span class=p>.</span><span class=na>getConfig</span><span class=p>().</span><span class=na>getOptionalValue</span><span class=p>(</span><span class=s>&quot;database.name&quot;</span><span class=p>,</span><span class=w> </span><span class=n>String</span><span class=p>.</span><span class=na>class</span><span class=p>);</span>
</code></pre></div> <p>Quarkus supports the notion of configuration profiles. These allow you to have multiple configuration in the same file and select between them via a profile name.</p> <p>See also <a href=https://quarkus.io/guides/config#using-property-expressions>Using Property Expressions</a></p> <h3 id=get-access-to-start-and-stop-application-events>Get access to start and stop application events<a class=headerlink href=#get-access-to-start-and-stop-application-events title="Permanent link">&para;</a></h3> <p>This is an important practice when we want to start a listener on Kafka topic for example or a kafka stream topology.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-35-1 name=__codelineno-35-1 href=#__codelineno-35-1></a><span class=kn>import</span><span class=w> </span><span class=nn>javax.enterprise.event.Observes</span><span class=p>;</span>
<a id=__codelineno-35-2 name=__codelineno-35-2 href=#__codelineno-35-2></a><span class=p>...</span>
<a id=__codelineno-35-3 name=__codelineno-35-3 href=#__codelineno-35-3></a><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>onStart</span><span class=p>(</span><span class=nd>@Observes</span><span class=w> </span><span class=n>StartupEvent</span><span class=w> </span><span class=n>ev</span><span class=p>){}</span>
<a id=__codelineno-35-4 name=__codelineno-35-4 href=#__codelineno-35-4></a>
<a id=__codelineno-35-5 name=__codelineno-35-5 href=#__codelineno-35-5></a><span class=w> </span><span class=kt>void</span><span class=w> </span><span class=nf>onStop</span><span class=p>(</span><span class=nd>@Observes</span><span class=w> </span><span class=n>ShutdownEvent</span><span class=w> </span><span class=n>ev</span><span class=p>)</span><span class=w> </span><span class=p>{</span><span class=w> </span><span class=p>}</span>
</code></pre></div> <h3 id=testing-with-moquito>Testing with Moquito<a class=headerlink href=#testing-with-moquito title="Permanent link">&para;</a></h3> <p>Declare the beans to Injected in the Test class. Then a static method to create and moquito them. See <a href=https://quarkus.io/blog/mocking/ >this quarkus blog</a></p> <p><a href=https://javadoc.io/doc/org.mockito/mockito-core/latest/org/mockito/Mockito.html>Mockito API</a></p> <div class=highlight><pre><span></span><code><a id=__codelineno-36-1 name=__codelineno-36-1 href=#__codelineno-36-1></a><span class=w> </span><span class=n>JMSQueueWriter</span><span class=w> </span><span class=n>mockJMSWriter</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Mockito</span><span class=p>.</span><span class=na>mock</span><span class=p>(</span><span class=n>JMSQueueWriter</span><span class=p>.</span><span class=na>class</span><span class=p>);</span><span class=w>  </span>
<a id=__codelineno-36-2 name=__codelineno-36-2 href=#__codelineno-36-2></a><span class=w>        </span><span class=n>Mockito</span><span class=p>.</span><span class=na>when</span><span class=p>(</span><span class=n>mockJMSWriter</span><span class=p>.</span><span class=na>sendMessage</span><span class=p>(</span><span class=n>any</span><span class=p>(),</span><span class=n>anyString</span><span class=p>())).</span><span class=na>thenReturn</span><span class=p>(</span><span class=s>&quot;Success&quot;</span><span class=p>);</span>
<a id=__codelineno-36-3 name=__codelineno-36-3 href=#__codelineno-36-3></a><span class=w>        </span><span class=n>QuarkusMock</span><span class=p>.</span><span class=na>installMockForType</span><span class=p>(</span><span class=n>mockJMSWriter</span><span class=p>,</span><span class=w> </span><span class=n>JMSQueueWriter</span><span class=p>.</span><span class=na>class</span><span class=p>);</span><span class=w>  </span>
</code></pre></div> <h3 id=reactive-with-mutiny>Reactive with Mutiny<a class=headerlink href=#reactive-with-mutiny title="Permanent link">&para;</a></h3> <p><a href=https://smallrye.io/smallrye-mutiny/ >Mutiny</a> is a reactive programming library to offer a more guided API than traditional reactive framework and API. It supports asynchronous, non-blocking programming, streams, event driven, back-pressure and data flows and only two types to manage asynchronous actions (Uni and Multi).</p> <p>Quarkus uses an event-loop to implement the reactive mode, based on Vert.X as reactive engine. To program with reactive or imperative, we use different APIs. Mutiny is such API.</p> <p>To asynchronously handle HTTP requests, the endpoint method must return a java.util.concurrent.CompletionStage or an <code>io.smallrye.mutiny.Uni</code> or <code>io.smallrye.mutiny.Multi</code>(requires the quarkus-resteasy-mutiny extension).</p> <p>With Mutiny both <code>Uni</code> and <code>Multi</code> expose event-driven APIs: you express what you want to do upon a given event (success, failure, etc.). These APIs are divided into groups (types of operations) to make it more expressive and avoid having 100s of methods attached to a single class.</p> <p><a href=https://smallrye.io/smallrye-mutiny/#_uni_and_multi>This section of the product documentation</a> goes over some examples on how to use Uni/ Multi.</p> <p>Here are some basic examples:</p> <ul> <li>Support asynchronous REST end point</li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-37-1 name=__codelineno-37-1 href=#__codelineno-37-1></a><span class=w>    </span><span class=nd>@GET</span>
<a id=__codelineno-37-2 name=__codelineno-37-2 href=#__codelineno-37-2></a><span class=w>    </span><span class=nd>@Produces</span><span class=p>(</span><span class=n>MediaType</span><span class=p>.</span><span class=na>APPLICATION_JSON</span><span class=p>)</span>
<a id=__codelineno-37-3 name=__codelineno-37-3 href=#__codelineno-37-3></a><span class=w>    </span><span class=nd>@Path</span><span class=p>(</span><span class=s>&quot;/json/{id}&quot;</span><span class=p>)</span>
<a id=__codelineno-37-4 name=__codelineno-37-4 href=#__codelineno-37-4></a><span class=w>  </span><span class=c1>// producing generic json object</span>
<a id=__codelineno-37-5 name=__codelineno-37-5 href=#__codelineno-37-5></a><span class=w>  </span><span class=kd>public</span><span class=w> </span><span class=n>Uni</span><span class=o>&lt;</span><span class=n>JsonObject</span><span class=o>&gt;</span><span class=w> </span><span class=nf>getJsonObject</span><span class=p>(</span><span class=nd>@PathParam</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>id</span><span class=p>){</span>
<a id=__codelineno-37-6 name=__codelineno-37-6 href=#__codelineno-37-6></a><span class=w>        </span><span class=n>JsonObject</span><span class=w> </span><span class=n>order</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>JsonObject</span><span class=p>(</span><span class=s>&quot;{\&quot;name\&quot;: \&quot;hello you\&quot;, \&quot;id\&quot;: \&quot;&quot;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>id</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=s>&quot;\&quot;}&quot;</span><span class=p>);</span>
<a id=__codelineno-37-7 name=__codelineno-37-7 href=#__codelineno-37-7></a><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>Uni</span><span class=p>.</span><span class=na>createFrom</span><span class=p>().</span><span class=na>item</span><span class=p>(</span><span class=w> </span><span class=n>order</span><span class=p>);</span>
<a id=__codelineno-37-8 name=__codelineno-37-8 href=#__codelineno-37-8></a><span class=w>    </span><span class=p>}</span>
<a id=__codelineno-37-9 name=__codelineno-37-9 href=#__codelineno-37-9></a>
<a id=__codelineno-37-10 name=__codelineno-37-10 href=#__codelineno-37-10></a><span class=w>    </span><span class=c1>// Producing a bean</span>
<a id=__codelineno-37-11 name=__codelineno-37-11 href=#__codelineno-37-11></a><span class=w>    </span><span class=nd>@GET</span>
<a id=__codelineno-37-12 name=__codelineno-37-12 href=#__codelineno-37-12></a><span class=w>    </span><span class=nd>@Produces</span><span class=p>(</span><span class=n>MediaType</span><span class=p>.</span><span class=na>APPLICATION_JSON</span><span class=p>)</span>
<a id=__codelineno-37-13 name=__codelineno-37-13 href=#__codelineno-37-13></a><span class=w>    </span><span class=nd>@Path</span><span class=p>(</span><span class=s>&quot;/order/{id}&quot;</span><span class=p>)</span>
<a id=__codelineno-37-14 name=__codelineno-37-14 href=#__codelineno-37-14></a><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>Uni</span><span class=o>&lt;</span><span class=n>Order</span><span class=o>&gt;</span><span class=w> </span><span class=nf>getOrderById</span><span class=p>(</span><span class=nd>@PathParam</span><span class=w> </span><span class=n>String</span><span class=w> </span><span class=n>id</span><span class=p>){</span>
<a id=__codelineno-37-15 name=__codelineno-37-15 href=#__codelineno-37-15></a><span class=w>        </span><span class=n>Order</span><span class=w> </span><span class=n>o</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>Order</span><span class=p>();</span>
<a id=__codelineno-37-16 name=__codelineno-37-16 href=#__codelineno-37-16></a><span class=w>        </span><span class=n>o</span><span class=p>.</span><span class=na>deliveryLocation</span><span class=o>=</span><span class=s>&quot;Paris/France&quot;</span><span class=p>;</span>
<a id=__codelineno-37-17 name=__codelineno-37-17 href=#__codelineno-37-17></a><span class=w>        </span><span class=n>o</span><span class=p>.</span><span class=na>id</span><span class=o>=</span><span class=n>id</span><span class=p>;</span>
<a id=__codelineno-37-18 name=__codelineno-37-18 href=#__codelineno-37-18></a><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>Uni</span><span class=p>.</span><span class=na>createFrom</span><span class=p>().</span><span class=na>item</span><span class=p>(</span><span class=n>o</span><span class=p>);</span>
<a id=__codelineno-37-19 name=__codelineno-37-19 href=#__codelineno-37-19></a><span class=w>    </span><span class=p>}</span>
</code></pre></div> <ul> <li> <p>Calling an external service</p> <ol> <li>Create an interface about this service</li> <li>Call the service and use the different event to process success and failure </li> </ol> <div class=highlight><pre><span></span><code><a id=__codelineno-38-1 name=__codelineno-38-1 href=#__codelineno-38-1></a><span class=w>  </span><span class=kd>interface</span> <span class=nc>GreetingService</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-38-2 name=__codelineno-38-2 href=#__codelineno-38-2></a><span class=w>    </span><span class=n>Uni</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span><span class=w> </span><span class=nf>greeting</span><span class=p>(</span><span class=n>String</span><span class=w> </span><span class=n>name</span><span class=p>);</span>
<a id=__codelineno-38-3 name=__codelineno-38-3 href=#__codelineno-38-3></a><span class=w>  </span><span class=p>}</span>
<a id=__codelineno-38-4 name=__codelineno-38-4 href=#__codelineno-38-4></a>
<a id=__codelineno-38-5 name=__codelineno-38-5 href=#__codelineno-38-5></a><span class=c1>//somewhere in a class</span>
<a id=__codelineno-38-6 name=__codelineno-38-6 href=#__codelineno-38-6></a><span class=w> </span><span class=n>greetingService</span><span class=p>.</span><span class=na>greeting</span><span class=p>(</span><span class=s>&quot;Luke&quot;</span><span class=p>)</span>
<a id=__codelineno-38-7 name=__codelineno-38-7 href=#__codelineno-38-7></a><span class=w>            </span><span class=p>.</span><span class=na>subscribe</span><span class=p>().</span><span class=na>with</span><span class=p>(</span>
<a id=__codelineno-38-8 name=__codelineno-38-8 href=#__codelineno-38-8></a><span class=w>            </span><span class=n>item</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=n>item</span><span class=p>),</span>
<a id=__codelineno-38-9 name=__codelineno-38-9 href=#__codelineno-38-9></a><span class=w>            </span><span class=n>failure</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;Oh no! &quot;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>failure</span><span class=p>.</span><span class=na>getMessage</span><span class=p>())</span>
<a id=__codelineno-38-10 name=__codelineno-38-10 href=#__codelineno-38-10></a><span class=w>    </span><span class=p>);</span>
</code></pre></div> </li> <li> <p>Processing data as stream:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-39-1 name=__codelineno-39-1 href=#__codelineno-39-1></a><span class=w> </span><span class=n>Multi</span><span class=o>&lt;</span><span class=n>String</span><span class=o>&gt;</span><span class=w> </span><span class=n>stream</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>Multi</span><span class=p>.</span><span class=na>createFrom</span><span class=p>().</span><span class=na>items</span><span class=p>(</span><span class=s>&quot;a&quot;</span><span class=p>,</span><span class=w> </span><span class=s>&quot;b&quot;</span><span class=p>,</span><span class=w> </span><span class=s>&quot;c&quot;</span><span class=p>,</span><span class=w> </span><span class=s>&quot;d&quot;</span><span class=p>);</span>
<a id=__codelineno-39-2 name=__codelineno-39-2 href=#__codelineno-39-2></a><span class=w>    </span><span class=n>stream</span>
<a id=__codelineno-39-3 name=__codelineno-39-3 href=#__codelineno-39-3></a><span class=w>            </span><span class=p>.</span><span class=na>subscribe</span><span class=p>().</span><span class=na>with</span><span class=p>(</span>
<a id=__codelineno-39-4 name=__codelineno-39-4 href=#__codelineno-39-4></a><span class=w>                </span><span class=n>item</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;Received an item: &quot;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>item</span><span class=p>),</span>
<a id=__codelineno-39-5 name=__codelineno-39-5 href=#__codelineno-39-5></a><span class=w>                </span><span class=n>failure</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;Oh no! Received a failure: &quot;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>failure</span><span class=p>.</span><span class=na>getMessage</span><span class=p>()),</span>
<a id=__codelineno-39-6 name=__codelineno-39-6 href=#__codelineno-39-6></a><span class=w>                </span><span class=p>()</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;Received the completion signal&quot;</span><span class=p>)</span>
<a id=__codelineno-39-7 name=__codelineno-39-7 href=#__codelineno-39-7></a><span class=w>    </span><span class=p>);</span>
</code></pre></div> </li> <li> <p>Create a multi from a list and send to kafka</p> </li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-40-1 name=__codelineno-40-1 href=#__codelineno-40-1></a><span class=w>  </span><span class=nd>@Inject</span>
<a id=__codelineno-40-2 name=__codelineno-40-2 href=#__codelineno-40-2></a><span class=w>  </span><span class=nd>@Channel</span><span class=p>(</span><span class=s>&quot;items&quot;</span><span class=p>)</span>
<a id=__codelineno-40-3 name=__codelineno-40-3 href=#__codelineno-40-3></a><span class=w>  </span><span class=n>Emitter</span><span class=o>&lt;</span><span class=n>Item</span><span class=o>&gt;</span><span class=w> </span><span class=n>emitter</span><span class=p>;</span>
<a id=__codelineno-40-4 name=__codelineno-40-4 href=#__codelineno-40-4></a>
<a id=__codelineno-40-5 name=__codelineno-40-5 href=#__codelineno-40-5></a><span class=w> </span><span class=n>Multi</span><span class=p>.</span><span class=na>createFrom</span><span class=p>().</span><span class=na>items</span><span class=p>(</span><span class=n>buildItems</span><span class=p>(</span><span class=n>numberOfRecords</span><span class=p>).</span><span class=na>stream</span><span class=p>())</span>
<a id=__codelineno-40-6 name=__codelineno-40-6 href=#__codelineno-40-6></a><span class=w>                </span><span class=p>.</span><span class=na>subscribe</span><span class=p>().</span><span class=na>with</span><span class=p>(</span><span class=w> </span><span class=n>item</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-40-7 name=__codelineno-40-7 href=#__codelineno-40-7></a><span class=w>                    </span><span class=n>logger</span><span class=p>.</span><span class=na>warning</span><span class=p>(</span><span class=s>&quot;send &quot;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>item</span><span class=p>.</span><span class=na>toString</span><span class=p>());</span>
<a id=__codelineno-40-8 name=__codelineno-40-8 href=#__codelineno-40-8></a><span class=w>                    </span><span class=c1>//KafkaRecord&lt;String, Item&gt; record = KafkaRecord.of(item.sku,item);</span>
<a id=__codelineno-40-9 name=__codelineno-40-9 href=#__codelineno-40-9></a><span class=w>                    </span><span class=n>CompletionStage</span><span class=o>&lt;</span><span class=n>Void</span><span class=o>&gt;</span><span class=w> </span><span class=n>acked</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>emitter</span><span class=p>.</span><span class=na>send</span><span class=p>(</span><span class=n>item</span><span class=p>);</span>
<a id=__codelineno-40-10 name=__codelineno-40-10 href=#__codelineno-40-10></a><span class=w>                    </span><span class=n>acked</span><span class=p>.</span><span class=na>toCompletableFuture</span><span class=p>().</span><span class=na>join</span><span class=p>();</span>
<a id=__codelineno-40-11 name=__codelineno-40-11 href=#__codelineno-40-11></a><span class=w>                    </span><span class=p>},</span>
<a id=__codelineno-40-12 name=__codelineno-40-12 href=#__codelineno-40-12></a><span class=w>                    </span><span class=n>failure</span><span class=w> </span><span class=o>-&gt;</span><span class=w> </span><span class=n>System</span><span class=p>.</span><span class=na>out</span><span class=p>.</span><span class=na>println</span><span class=p>(</span><span class=s>&quot;Failed with &quot;</span><span class=w> </span><span class=o>+</span><span class=w> </span><span class=n>failure</span><span class=p>.</span><span class=na>getMessage</span><span class=p>()));</span>
</code></pre></div> <p>Events won’t begin flowing through the data streams until a subscriber requests them.</p> <h3 id=reactive-messaging>Reactive messaging<a class=headerlink href=#reactive-messaging title="Permanent link">&para;</a></h3> <p>Content built from Quarkus guide and Clement Escoffier's book.</p> <p>For a quick review of a reactive messaging guide search <code>reactive messaging</code> Quarkus tutorial is <a href=https://quarkus.io/guides/kafka-reactive-getting-started>here</a></p> <p>See <a href=https://ibm-cloud-architecture.github.io/refarch-eda/advantages/reactive/ >also this article</a> for reactive programming and system summary.</p> <p>Quick summary:</p> <ul> <li>Reactive Messaging integrates with various messaging technologies, such as Apache Kafka, AMQP, and others...</li> <li>Add extension: <code>quarkus ext add smallrye-reactive-messaging-kafka</code></li> <li>No need to start a Kafka broker when using the dev mode or for tests. Quarkus starts redpanda container and apicurio if using schema</li> <li>Define an application scoped bean for your service. See code template in <a href=https://github.com/ibm-cloud-architecture/eda-quickstarts/tree/main/quarkus-reactive-kafka-producer>eda-quickstarts/quarkus-reactive-kafka-producer</a></li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-41-1 name=__codelineno-41-1 href=#__codelineno-41-1></a><span class=nd>@ApplicationScoped</span>
<a id=__codelineno-41-2 name=__codelineno-41-2 href=#__codelineno-41-2></a><span class=kd>public</span><span class=w> </span><span class=kd>class</span> <span class=nc>OrderService</span><span class=w> </span><span class=p>{</span>
<a id=__codelineno-41-3 name=__codelineno-41-3 href=#__codelineno-41-3></a><span class=w>    </span><span class=nd>@Channel</span><span class=p>(</span><span class=s>&quot;orders&quot;</span><span class=p>)</span>
<a id=__codelineno-41-4 name=__codelineno-41-4 href=#__codelineno-41-4></a><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>Emitter</span><span class=o>&lt;</span><span class=n>OrderEvent</span><span class=o>&gt;</span><span class=w> </span><span class=n>eventProducer</span><span class=w> </span><span class=p>;</span>
<a id=__codelineno-41-5 name=__codelineno-41-5 href=#__codelineno-41-5></a>
<a id=__codelineno-41-6 name=__codelineno-41-6 href=#__codelineno-41-6></a><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>OrderEntity</span><span class=w> </span><span class=nf>createOrder</span><span class=p>(</span><span class=n>OrderEntity</span><span class=w> </span><span class=n>order</span><span class=p>){</span>
<a id=__codelineno-41-7 name=__codelineno-41-7 href=#__codelineno-41-7></a><span class=w>      </span><span class=n>OrderEvent</span><span class=w> </span><span class=n>orderEvent</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>OrderEvent</span><span class=p>.</span><span class=na>from</span><span class=p>(</span><span class=n>order</span><span class=p>);</span>
<a id=__codelineno-41-8 name=__codelineno-41-8 href=#__codelineno-41-8></a><span class=w>      </span><span class=n>eventProducer</span><span class=p>.</span><span class=na>send</span><span class=p>(</span><span class=n>orderEvent</span><span class=p>);</span>
<a id=__codelineno-41-9 name=__codelineno-41-9 href=#__codelineno-41-9></a><span class=w>    </span><span class=p>}</span>
</code></pre></div> <ul> <li>define channel properties in <code>application.properties</code>.</li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-42-1 name=__codelineno-42-1 href=#__codelineno-42-1></a>mp.messaging.outgoing.orders.connector<span class=o>=</span>smallrye-kafka
<a id=__codelineno-42-2 name=__codelineno-42-2 href=#__codelineno-42-2></a>mp.messaging.outgoing.orders.topic<span class=o>=</span>orders
<a id=__codelineno-42-3 name=__codelineno-42-3 href=#__codelineno-42-3></a>mp.messaging.outgoing.orders.value.serializer<span class=o>=</span>io.quarkus.kafka.client.serialization.ObjectMapperSerializer
<a id=__codelineno-42-4 name=__codelineno-42-4 href=#__codelineno-42-4></a><span class=c1># automatically register the schema with the registry, if not present</span>
<a id=__codelineno-42-5 name=__codelineno-42-5 href=#__codelineno-42-5></a>mp.messaging.outgoing.orders.apicurio.registry.auto-register<span class=o>=</span><span class=nb>true</span>
</code></pre></div> <ul> <li> <p>On the consumer side, use <code>@Incoming</code> annotation with channel name on top of function to process the message from kafka</p> </li> <li> <p>Use Kafka connector: <code>mp.messaging.incoming.[channel-name].connector=smallrye-kafka</code></p> </li> <li> <p>Implement Deserializer using Jsonb or Jackson. See <a href=https://quarkus.io/guides/kafka#serializing-via-json-b>this section</a>. </p> </li> <li> <p>When using Avro and Apicurio schema registry then the deserializer needs to be <code>io.apicurio.registry.utils.serde.AvroKafkaDeserializer</code> But with Quarkus 2.5 the deserializer and serializer are set by default.</p> </li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-43-1 name=__codelineno-43-1 href=#__codelineno-43-1></a><span class="l l-Scalar l-Scalar-Plain">mp.messaging.incoming.shipments.value.deserializer=io.apicurio.registry.utils.serde.AvroKafkaDeserializer</span>
<a id=__codelineno-43-2 name=__codelineno-43-2 href=#__codelineno-43-2></a><span class="l l-Scalar l-Scalar-Plain">mp.messaging.incoming.shipments.apicurio.registry.url=${SCHEMA_REGISTRY_URL}</span>
<a id=__codelineno-43-3 name=__codelineno-43-3 href=#__codelineno-43-3></a><span class="l l-Scalar l-Scalar-Plain">mp.messaging.incoming.shipments.specific.avro.reader=true</span>
<a id=__codelineno-43-4 name=__codelineno-43-4 href=#__codelineno-43-4></a><span class="l l-Scalar l-Scalar-Plain">mp.messaging.incoming.shipments.apicurio.registry.avro-datum-provider=io.apicurio.registry.utils.serde.avro.ReflectAvroDatumProvider</span>
<a id=__codelineno-43-5 name=__codelineno-43-5 href=#__codelineno-43-5></a><span class="l l-Scalar l-Scalar-Plain">mp.messaging.incoming.shipments.apicurio.registry.as-confluent=true</span>
</code></pre></div> <p>Nice <a href=https://lordofthejars.github.io/quarkus-cheat-sheet/#_reactive_messaging>cheat sheet</a> to combine Mutiny, Reactive messaging.</p> <ul> <li>It is possible to combine imperative and reactive: so on a POST api, the code emits event to Kafka. We just need to inject an emitter as below:</li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-44-1 name=__codelineno-44-1 href=#__codelineno-44-1></a><span class=w>  </span><span class=nd>@Inject</span><span class=w> </span><span class=nd>@Channel</span><span class=p>(</span><span class=s>&quot;items&quot;</span><span class=p>)</span><span class=w> </span><span class=n>Emitter</span><span class=o>&lt;</span><span class=n>KafkaRecord</span><span class=o>&lt;</span><span class=n>String</span><span class=p>,</span><span class=w> </span><span class=n>Item</span><span class=o>&gt;&gt;</span><span class=w> </span><span class=n>emitter</span><span class=p>;</span>
</code></pre></div> <p>Emitting Kafka Records will duplicate the payload.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-45-1 name=__codelineno-45-1 href=#__codelineno-45-1></a><span class=p>{</span><span class=nt>&quot;headers&quot;</span><span class=p>:{},</span>
<a id=__codelineno-45-2 name=__codelineno-45-2 href=#__codelineno-45-2></a><span class=nt>&quot;key&quot;</span><span class=p>:</span><span class=s2>&quot;Item_4&quot;</span><span class=p>,</span>
<a id=__codelineno-45-3 name=__codelineno-45-3 href=#__codelineno-45-3></a><span class=nt>&quot;metadata&quot;</span><span class=p>:{},</span><span class=nt>&quot;partition&quot;</span><span class=p>:</span><span class=mi>-1</span><span class=p>,</span>
<a id=__codelineno-45-4 name=__codelineno-45-4 href=#__codelineno-45-4></a><span class=nt>&quot;payload&quot;</span><span class=p>:{</span><span class=nt>&quot;id&quot;</span><span class=p>:</span><span class=mi>296</span><span class=p>,</span><span class=nt>&quot;price&quot;</span><span class=p>:</span><span class=mf>72.9</span><span class=p>,</span><span class=nt>&quot;quantity&quot;</span><span class=p>:</span><span class=mi>7</span><span class=p>,</span><span class=nt>&quot;sku&quot;</span><span class=p>:</span><span class=s2>&quot;Item_4&quot;</span><span class=p>,</span><span class=nt>&quot;storeName&quot;</span><span class=p>:</span><span class=s2>&quot;Store_2&quot;</span><span class=p>}}</span>
</code></pre></div> <p>To send directly the payload with a key, use a Message instance.</p> <p><a href=https://smallrye.io/smallrye-reactive-messaging/smallrye-reactive-messaging/2/kafka/kafka.html>Apache Kafka specific for reactive messaging</a></p> <p>The Kafka Connector is based on the Vert.x Kafka Client.</p> <h3 id=a-case-for-kafka-to-sse>A case for Kafka to SSE<a class=headerlink href=#a-case-for-kafka-to-sse title="Permanent link">&para;</a></h3> <p>A nice capability is to open a Server Side Event end point (see code in <a href=https://github.com/ibm-cloud-architecture/vaccine-freezer-mgr>freezer mgr project</a>):</p> <p>In the API resource class:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-46-1 name=__codelineno-46-1 href=#__codelineno-46-1></a><span class=w>    </span><span class=nd>@Inject</span>
<a id=__codelineno-46-2 name=__codelineno-46-2 href=#__codelineno-46-2></a><span class=w>    </span><span class=nd>@Channel</span><span class=p>(</span><span class=s>&quot;internal-alert-stream&quot;</span><span class=p>)</span>
<a id=__codelineno-46-3 name=__codelineno-46-3 href=#__codelineno-46-3></a><span class=w>    </span><span class=n>Publisher</span><span class=o>&lt;</span><span class=n>ReeferAlert</span><span class=o>&gt;</span><span class=w> </span><span class=n>alerts</span><span class=p>;</span>
<a id=__codelineno-46-4 name=__codelineno-46-4 href=#__codelineno-46-4></a>
<a id=__codelineno-46-5 name=__codelineno-46-5 href=#__codelineno-46-5></a><span class=w>    </span><span class=nd>@GET</span>
<a id=__codelineno-46-6 name=__codelineno-46-6 href=#__codelineno-46-6></a><span class=w>    </span><span class=nd>@Path</span><span class=p>(</span><span class=s>&quot;/alerts&quot;</span><span class=p>)</span>
<a id=__codelineno-46-7 name=__codelineno-46-7 href=#__codelineno-46-7></a><span class=w>    </span><span class=nd>@Produces</span><span class=p>(</span><span class=n>MediaType</span><span class=p>.</span><span class=na>SERVER_SENT_EVENTS</span><span class=p>)</span>
<a id=__codelineno-46-8 name=__codelineno-46-8 href=#__codelineno-46-8></a><span class=w>    </span><span class=nd>@SseElementType</span><span class=p>(</span><span class=n>MediaType</span><span class=p>.</span><span class=na>APPLICATION_JSON</span><span class=p>)</span>
<a id=__codelineno-46-9 name=__codelineno-46-9 href=#__codelineno-46-9></a><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>Publisher</span><span class=o>&lt;</span><span class=n>ReeferAlert</span><span class=o>&gt;</span><span class=w> </span><span class=nf>streamAlerts</span><span class=p>(){</span>
<a id=__codelineno-46-10 name=__codelineno-46-10 href=#__codelineno-46-10></a><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>alerts</span><span class=p>;</span>
<a id=__codelineno-46-11 name=__codelineno-46-11 href=#__codelineno-46-11></a><span class=w>    </span><span class=p>}</span>
</code></pre></div> <p>In the service class, the incoming channel is connected to Kafka and the outgoing is an internal channel to broadcast message to it.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-47-1 name=__codelineno-47-1 href=#__codelineno-47-1></a><span class=w>    </span><span class=nd>@Incoming</span><span class=p>(</span><span class=s>&quot;reefer-alerts&quot;</span><span class=p>)</span><span class=w>                                     </span>
<a id=__codelineno-47-2 name=__codelineno-47-2 href=#__codelineno-47-2></a><span class=w>    </span><span class=nd>@Outgoing</span><span class=p>(</span><span class=s>&quot;internal-alert-stream&quot;</span><span class=p>)</span><span class=w>                             </span>
<a id=__codelineno-47-3 name=__codelineno-47-3 href=#__codelineno-47-3></a><span class=w>    </span><span class=nd>@Broadcast</span><span class=w>                                              </span>
<a id=__codelineno-47-4 name=__codelineno-47-4 href=#__codelineno-47-4></a><span class=w>    </span><span class=nd>@Acknowledgment</span><span class=p>(</span><span class=n>Acknowledgment</span><span class=p>.</span><span class=na>Strategy</span><span class=p>.</span><span class=na>PRE_PROCESSING</span><span class=p>)</span>
<a id=__codelineno-47-5 name=__codelineno-47-5 href=#__codelineno-47-5></a><span class=w>    </span><span class=kd>public</span><span class=w> </span><span class=n>ReeferAlert</span><span class=w> </span><span class=nf>process</span><span class=p>(</span><span class=n>ReeferAlert</span><span class=w> </span><span class=n>inAlert</span><span class=p>){</span>
<a id=__codelineno-47-6 name=__codelineno-47-6 href=#__codelineno-47-6></a><span class=w>        </span><span class=c1>// process the alert and generate the message to broadcast to SSE</span>
<a id=__codelineno-47-7 name=__codelineno-47-7 href=#__codelineno-47-7></a><span class=w>        </span><span class=k>return</span><span class=w> </span><span class=n>inAlert</span><span class=p>;</span>
<a id=__codelineno-47-8 name=__codelineno-47-8 href=#__codelineno-47-8></a><span class=w>    </span><span class=p>}</span>
</code></pre></div> <h3 id=rest-client>REST Client<a class=headerlink href=#rest-client title="Permanent link">&para;</a></h3> <ul> <li>Install client jars</li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-48-1 name=__codelineno-48-1 href=#__codelineno-48-1></a>quarkus<span class=w> </span>ext<span class=w>  </span>add<span class=w> </span>rest-client-reactive-jackson
</code></pre></div> <ul> <li>Add an interface</li> </ul> <h2 id=adopting-vertx>Adopting Vertx<a class=headerlink href=#adopting-vertx title="Permanent link">&para;</a></h2> <p>Quarkus is based on Vert.x, and almost all network-related features rely on Vert.x / Netty. Every IO interaction passes through the non-blocking and reactive Vert.x engine. The (Vert.x) HTTP server receives the request and then routes it to the application. If the request targets a JAX-RS resource, the routing layer invokes the resource method in a worker thread and writes the response when the data is available. But if the HTTP request targets a reactive (non-blocking) route, the routing layer invokes the route on the IO thread giving lots of benefits such as higher concurrency and performance.</p> <p><img alt=1 src=https://quarkus.io/guides/images/http-reactive-sequence.png></p> <p>To fully benefit from this model, the application code should be written in a non-blocking manner.</p> <p>Add the extension: <code>./mvnw quarkus:add-extension -Dextensions="vertx"</code>. Get access to Vert.x via injection: </p> <div class=highlight><pre><span></span><code><a id=__codelineno-49-1 name=__codelineno-49-1 href=#__codelineno-49-1></a><span class=nd>@Inject</span><span class=w> </span><span class=n>Vertx</span><span class=w> </span><span class=n>vertx</span><span class=p>;</span>
</code></pre></div> <p>When using the Mutiny API to program in reactive approach, then the Vert.x package is <code>io.vertx.mutiny.core.Vertx</code>.</p> <h2 id=typical-problems>Typical problems<a class=headerlink href=#typical-problems title="Permanent link">&para;</a></h2> <h3 id=running-cloud-native>Running cloud native<a class=headerlink href=#running-cloud-native title="Permanent link">&para;</a></h3> <p>By default, when building a native executable, GraalVM will not include any of the resources that are on the classpath into the native executable it creates. Resources that are meant to be part of the native executable need to be configured explicitly.</p> <p><a href=https://quarkus.io/guides/writing-native-applications-tips>See writing native app tips</a></p> <h3 id=run-quarkus-test-with-external-components-started-with-docker-compose>Run quarkus test with external components started with docker compose<a class=headerlink href=#run-quarkus-test-with-external-components-started-with-docker-compose title="Permanent link">&para;</a></h3> <p>The best approach is to avoid using docker-compose for development and use <a href=../../coding/testcontainer/ >TestContainer</a>.</p> <h3 id=cheat-sheet>Cheat-Sheet<a class=headerlink href=#cheat-sheet title="Permanent link">&para;</a></h3> <ul> <li><a href=https://lordofthejars.github.io/quarkus-cheat-sheet/ >Official</a></li> </ul> <h3 id=to-read>To read<a class=headerlink href=#to-read title="Permanent link">&para;</a></h3> <ul> <li><a href=https://developers.redhat.com/blog/2020/01/23/using-kubernetes-configmaps-to-define-your-quarkus-applications-properties/ >Using Kubernetes ConfigMaps to define your Quarkus application’s properties</a></li> <li><a href=https://medium.com/@hantsy/building-reactive-apis-with-quarkus-86bb12523da1>Reactive Programming with Quarkus - postgresql reactive with mutiny</a></li> </ul> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../openliberty/ class="md-footer__link md-footer__link--prev" aria-label="Previous: Open Liberty"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Previous </span> <div class=md-ellipsis> Open Liberty </div> </div> </a> <a href=../restassured/ class="md-footer__link md-footer__link--next" aria-label="Next: Rest assured"> <div class=md-footer__title> <span class=md-footer__direction> Next </span> <div class=md-ellipsis> Rest assured </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2018 - 2024 Jerome Boyer </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://github.com/jbcodeforce target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </a> <a href=https://linkedin.com/in/jeromeboyer target=_blank rel=noopener title=linkedin.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5m282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg> </a> <a href target=_blank rel=noopener title class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M498.1 5.6c10.1 7 15.4 19.1 13.5 31.2l-64 416c-1.5 9.7-7.4 18.2-16 23s-18.9 5.4-28 1.6L284 427.7l-68.5 74.1c-8.9 9.7-22.9 12.9-35.2 8.1S160 493.2 160 480v-83.6c0-4 1.5-7.8 4.2-10.8l167.6-182.8c5.8-6.3 5.6-16-.4-22s-15.7-6.4-22-.7L106 360.8l-88.3-44.2C7.1 311.3.3 300.7 0 288.9s5.9-22.8 16.1-28.7l448-256c10.7-6.1 23.9-5.5 34 1.4"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <div class=md-progress data-md-component=progress role=progressbar></div> <script id=__config type=application/json>{"base": "../..", "features": ["content.code.annotate", "content.code.copy", "content.tooltips", "search.highlight", "navigation.instant", "navigation.instant.progress", "navigation.tabs", "navigation.instant", "navigation.tabs.sticky", "navigation.tracking", "navigation.footer", "navigation.tabs.sticky", "navigation.top"], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script> <script src=../../assets/javascripts/bundle.525ec568.min.js></script> </body> </html>