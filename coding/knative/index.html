<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Knowledge acquisition personal's notes, blog drafts"><link href=https://jeromeboyer.net/coding/knative/ rel=canonical><link href=../istio/ rel=prev><link href=../../code-template/ rel=next><link rel=icon href=../../images/logo-blue.drawio.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.5.39"><title>Knative - Jerome Boyer's Personal Site</title><link rel=stylesheet href=../../assets/stylesheets/main.8c3ca2c6.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.06af60db.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../extra.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#knative class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--shadow md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../.. title="Jerome Boyer's Personal Site" class="md-header__button md-logo" aria-label="Jerome Boyer's Personal Site" data-md-component=logo> <img src=../../images/logo.drawio.png alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Jerome Boyer's Personal Site </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Knative </span> </div> </div> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" title=Clear aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/jbcodeforce/jbcodeforce.github.io/ title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../about/ class=md-tabs__link> Home </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../playground/ class=md-tabs__link> Coding </a> </li> <li class=md-tabs__item> <a href=../../blogs/consultant-job/ class=md-tabs__link> Knowledge base </a> </li> <li class=md-tabs__item> <a href=../../techno/apicurio/ class=md-tabs__link> Techno </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="Jerome Boyer's Personal Site" class="md-nav__button md-logo" aria-label="Jerome Boyer's Personal Site" data-md-component=logo> <img src=../../images/logo.drawio.png alt=logo> </a> Jerome Boyer's Personal Site </label> <div class=md-nav__source> <a href=https://github.com/jbcodeforce/jbcodeforce.github.io/ title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg> </div> <div class=md-source__repository> GitHub </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_1> <label class=md-nav__link for=__nav_1 id=__nav_1_label tabindex=0> <span class=md-ellipsis> Home </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_1_label aria-expanded=false> <label class=md-nav__title for=__nav_1> <span class="md-nav__icon md-icon"></span> Home </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../about/ class=md-nav__link> <span class=md-ellipsis> About </span> </a> </li> <li class=md-nav__item> <a href=../../skills/ class=md-nav__link> <span class=md-ellipsis> Skills </span> </a> </li> <li class=md-nav__item> <a href=../../blogs/ class=md-nav__link> <span class=md-ellipsis> Blogs </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_1_4> <label class=md-nav__link for=__nav_1_4 id=__nav_1_4_label tabindex=0> <span class=md-ellipsis> Leasure </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_1_4_label aria-expanded=false> <label class=md-nav__title for=__nav_1_4> <span class="md-nav__icon md-icon"></span> Leasure </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../astronomy/ class=md-nav__link> <span class=md-ellipsis> Astronomy </span> </a> </li> <li class=md-nav__item> <a href=../../astronomy/physic/ class=md-nav__link> <span class=md-ellipsis> Physic - Newton </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2 checked> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex> <span class=md-ellipsis> Coding </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=true> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Coding </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../playground/ class=md-nav__link> <span class=md-ellipsis> Playground </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_2> <label class=md-nav__link for=__nav_2_2 id=__nav_2_2_label tabindex=0> <span class=md-ellipsis> Dev & Ops </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2_2> <span class="md-nav__icon md-icon"></span> Dev & Ops </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../agile/ class=md-nav__link> <span class=md-ellipsis> Agile </span> </a> </li> <li class=md-nav__item> <a href=../git/ class=md-nav__link> <span class=md-ellipsis> Git summary </span> </a> </li> <li class=md-nav__item> <a href=../gitops/ class=md-nav__link> <span class=md-ellipsis> GitOps </span> </a> </li> <li class=md-nav__item> <a href=../tekton/ class=md-nav__link> <span class=md-ellipsis> Tekton </span> </a> </li> <li class=md-nav__item> <a href=../argocd/ class=md-nav__link> <span class=md-ellipsis> ArgoCD </span> </a> </li> <li class=md-nav__item> <a href=../finch/ class=md-nav__link> <span class=md-ellipsis> Finch </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3> <label class=md-nav__link for=__nav_2_3 id=__nav_2_3_label tabindex=0> <span class=md-ellipsis> Fun problems </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_3_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3> <span class="md-nav__icon md-icon"></span> Fun problems </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../fun/puzzles/ class=md-nav__link> <span class=md-ellipsis> puzzles </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_4> <label class=md-nav__link for=__nav_2_4 id=__nav_2_4_label tabindex=0> <span class=md-ellipsis> Java </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_4_label aria-expanded=false> <label class=md-nav__title for=__nav_2_4> <span class="md-nav__icon md-icon"></span> Java </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../java/ class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class=md-nav__item> <a href=../../java/FAQ/ class=md-nav__link> <span class=md-ellipsis> Java FAQ </span> </a> </li> <li class=md-nav__item> <a href=../../java/concurrent/ class=md-nav__link> <span class=md-ellipsis> Concurrency </span> </a> </li> <li class=md-nav__item> <a href=../../java/funqy/ class=md-nav__link> <span class=md-ellipsis> Funqy </span> </a> </li> <li class=md-nav__item> <a href=../../java/microprofile/ class=md-nav__link> <span class=md-ellipsis> Microprofile 3.x </span> </a> </li> <li class=md-nav__item> <a href=../../java/openliberty/ class=md-nav__link> <span class=md-ellipsis> Open Liberty </span> </a> </li> <li class=md-nav__item> <a href=../../java/quarkus/ class=md-nav__link> <span class=md-ellipsis> Quarkus </span> </a> </li> <li class=md-nav__item> <a href=../../java/restassured/ class=md-nav__link> <span class=md-ellipsis> Rest assured </span> </a> </li> <li class=md-nav__item> <a href=../../java/springcloud/ class=md-nav__link> <span class=md-ellipsis> SpringCloud </span> </a> </li> <li class=md-nav__item> <a href=../testcontainer/ class=md-nav__link> <span class=md-ellipsis> TestContainer </span> </a> </li> <li class=md-nav__item> <a href=../../java/vertx/ class=md-nav__link> <span class=md-ellipsis> Vert.x </span> </a> </li> <li class=md-nav__item> <a href=../../java/java-vscode/ class=md-nav__link> <span class=md-ellipsis> VScode </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../techno/podman/ class=md-nav__link> <span class=md-ellipsis> Podman </span> </a> </li> <li class=md-nav__item> <a href=../reactjs/ class=md-nav__link> <span class=md-ellipsis> React.js & next.js </span> </a> </li> <li class=md-nav__item> <a href=../istio/ class=md-nav__link> <span class=md-ellipsis> istio </span> </a> </li> <li class=md-nav__item> <a href=https://jbcodeforce.github.io/python-code class=md-nav__link> <span class=md-ellipsis> Python </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> Knative </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> Knative </span> </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#value-propositions class=md-nav__link> <span class=md-ellipsis> Value propositions </span> </a> <nav class=md-nav aria-label="Value propositions"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#challenges-based-on-aws-lambda-but-may-apply-to-knative class=md-nav__link> <span class=md-ellipsis> Challenges (based on AWS lambda but may apply to knative) </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#getting-started class=md-nav__link> <span class=md-ellipsis> Getting started </span> </a> </li> <li class=md-nav__item> <a href=#knative-serving class=md-nav__link> <span class=md-ellipsis> Knative serving </span> </a> <nav class=md-nav aria-label="Knative serving"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#define-a-service-for-a-docker-image class=md-nav__link> <span class=md-ellipsis> Define a service for a docker image </span> </a> </li> <li class=md-nav__item> <a href=#define-a-service-using-yaml class=md-nav__link> <span class=md-ellipsis> Define a service using yaml </span> </a> </li> <li class=md-nav__item> <a href=#knative-and-quarkus-app class=md-nav__link> <span class=md-ellipsis> Knative and Quarkus app </span> </a> </li> <li class=md-nav__item> <a href=#bluegreen-deployment class=md-nav__link> <span class=md-ellipsis> Blue/green deployment </span> </a> </li> <li class=md-nav__item> <a href=#canary-release class=md-nav__link> <span class=md-ellipsis> Canary release </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#knative-eventing class=md-nav__link> <span class=md-ellipsis> Knative eventing </span> </a> <nav class=md-nav aria-label="Knative eventing"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#source-and-sink class=md-nav__link> <span class=md-ellipsis> Source and sink </span> </a> </li> <li class=md-nav__item> <a href=#channel-and-subscribers class=md-nav__link> <span class=md-ellipsis> Channel and Subscribers </span> </a> </li> <li class=md-nav__item> <a href=#broker-and-trigger class=md-nav__link> <span class=md-ellipsis> Broker and Trigger </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#some-other-cli-commands class=md-nav__link> <span class=md-ellipsis> Some other CLI commands </span> </a> </li> <li class=md-nav__item> <a href=#troubleshooting class=md-nav__link> <span class=md-ellipsis> Troubleshooting </span> </a> </li> <li class=md-nav__item> <a href=#sources class=md-nav__link> <span class=md-ellipsis> Sources </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=https://jbcodeforce.github.io/vuejs-studies/ class=md-nav__link> <span class=md-ellipsis> Vue.js Studies </span> </a> </li> <li class=md-nav__item> <a href=https://cloudnative101.dev/ class=md-nav__link> <span class=md-ellipsis> Cloud native content IBM </span> </a> </li> <li class=md-nav__item> <a href=https://jbcodeforce.github.io/angular-sandbox/ class=md-nav__link> <span class=md-ellipsis> Angular </span> </a> </li> <li class=md-nav__item> <a href=../../code-template/ class=md-nav__link> <span class=md-ellipsis> My code templates </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class=md-ellipsis> Knowledge base </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Knowledge base </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../blogs/consultant-job/ class=md-nav__link> <span class=md-ellipsis> The SA job </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_2> <label class=md-nav__link for=__nav_3_2 id=__nav_3_2_label tabindex=0> <span class=md-ellipsis> Leadership </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_2_label aria-expanded=false> <label class=md-nav__title for=__nav_3_2> <span class="md-nav__icon md-icon"></span> Leadership </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../leadership/first-90-days/ class=md-nav__link> <span class=md-ellipsis> 90 Days </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_3> <label class=md-nav__link for=__nav_3_3 id=__nav_3_3_label tabindex=0> <span class=md-ellipsis> Architecture </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3_3> <span class="md-nav__icon md-icon"></span> Architecture </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../architecture/system-design/ class=md-nav__link> <span class=md-ellipsis> Conduct System Design </span> </a> </li> <li class=md-nav__item> <a href=https://jbcodeforce.github.io/eda-studies class=md-nav__link> <span class=md-ellipsis> Event Driven Architecture </span> </a> </li> <li class=md-nav__item> <a href=../../architecture/tcpip/ class=md-nav__link> <span class=md-ellipsis> TPC/IP summary </span> </a> </li> <li class=md-nav__item> <a href=../../architecture/flow-architectures/ class=md-nav__link> <span class=md-ellipsis> Flow architectures </span> </a> </li> <li class=md-nav__item> <a href=../../architecture/streaming/ class=md-nav__link> <span class=md-ellipsis> Streaming processing </span> </a> </li> <li class=md-nav__item> <a href=../../architecture/architectural-decisions/ class=md-nav__link> <span class=md-ellipsis> Architecture decision </span> </a> </li> <li class=md-nav__item> <a href="https://jbcodef orce.github.io/eda-studies/ddd" class=md-nav__link> <span class=md-ellipsis> DDD </span> </a> </li> <li class=md-nav__item> <a href=../../architecture/DR/ class=md-nav__link> <span class=md-ellipsis> Disaster recovery </span> </a> </li> <li class=md-nav__item> <a href=../istio/ class=md-nav__link> <span class=md-ellipsis> istio </span> </a> </li> <li class=md-nav__item> <a href=https://jbcodeforce.github.io/openshift-studies class=md-nav__link> <span class=md-ellipsis> Openshift Studies </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_4> <label class=md-nav__link for=__nav_3_4 id=__nav_3_4_label tabindex=0> <span class=md-ellipsis> Methodology </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_4_label aria-expanded=false> <label class=md-nav__title for=__nav_3_4> <span class="md-nav__icon md-icon"></span> Methodology </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../methodology/design-thinking/ class=md-nav__link> <span class=md-ellipsis> Design Thinking </span> </a> </li> <li class=md-nav__item> <a href=../../methodology/data-intensive/ class=md-nav__link> <span class=md-ellipsis> Data intensive </span> </a> </li> <li class=md-nav__item> <a href=https://jbcodeforce.github.io/eda-studies/event-storming/ class=md-nav__link> <span class=md-ellipsis> Event Storming </span> </a> </li> <li class=md-nav__item> <a href=https://jbcodeforce.github.io/eda-studies/ddd/ class=md-nav__link> <span class=md-ellipsis> Domain driven design </span> </a> </li> <li class=md-nav__item> <a href=../../methodology/lean-startup/ class=md-nav__link> <span class=md-ellipsis> Lean startup </span> </a> </li> <li class=md-nav__item> <a href=../../methodology/pm/ class=md-nav__link> <span class=md-ellipsis> Product manager </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_4_7> <label class=md-nav__link for=__nav_3_4_7 id=__nav_3_4_7_label tabindex=0> <span class=md-ellipsis> ABRD </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_3_4_7_label aria-expanded=false> <label class=md-nav__title for=__nav_3_4_7> <span class="md-nav__icon md-icon"></span> ABRD </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../methodology/abrd/ class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class=md-nav__item> <a href=../../methodology/abrd/concept/ class=md-nav__link> <span class=md-ellipsis> Concepts </span> </a> </li> <li class=md-nav__item> <a href=../../methodology/abrd/harvesting/ class=md-nav__link> <span class=md-ellipsis> Rule Harvesting </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../../methodology/narrative/ class=md-nav__link> <span class=md-ellipsis> Narratives </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_5> <label class=md-nav__link for=__nav_3_5 id=__nav_3_5_label tabindex=0> <span class=md-ellipsis> Data </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_5_label aria-expanded=false> <label class=md-nav__title for=__nav_3_5> <span class="md-nav__icon md-icon"></span> Data </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../data/ class=md-nav__link> <span class=md-ellipsis> Introduction </span> </a> </li> <li class=md-nav__item> <a href=../../techno/data/ class=md-nav__link> <span class=md-ellipsis> Iceberg & others </span> </a> </li> <li class=md-nav__item> <a href=https://jbcodeforce.github.io/db-play/ class=md-nav__link> <span class=md-ellipsis> Database play </span> </a> </li> <li class=md-nav__item> <a href=../../data/data-topology/ class=md-nav__link> <span class=md-ellipsis> Data topology </span> </a> </li> <li class=md-nav__item> <a href=../../data/data-integration/ class=md-nav__link> <span class=md-ellipsis> Data integration </span> </a> </li> <li class=md-nav__item> <a href=../../data/data-replication/ class=md-nav__link> <span class=md-ellipsis> Data replication </span> </a> </li> <li class=md-nav__item> <a href=../../data/data-partitioning/ class=md-nav__link> <span class=md-ellipsis> Data partitioning </span> </a> </li> <li class=md-nav__item> <a href=../../architecture/streaming/ class=md-nav__link> <span class=md-ellipsis> Streaming processing </span> </a> </li> <li class=md-nav__item> <a href=../../architecture/opendatahub/ class=md-nav__link> <span class=md-ellipsis> OpenData Hub </span> </a> </li> <li class=md-nav__item> <a href=../../data/olap/ class=md-nav__link> <span class=md-ellipsis> OLAP </span> </a> </li> <li class=md-nav__item> <a href=../../data/cassandra/ class=md-nav__link> <span class=md-ellipsis> Cassandra </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3_6> <label class=md-nav__link for=__nav_3_6 id=__nav_3_6_label tabindex=0> <span class=md-ellipsis> AI </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_3_6_label aria-expanded=false> <label class=md-nav__title for=__nav_3_6> <span class="md-nav__icon md-icon"></span> AI </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=https://jbcodeforce.github.io/ML-studies/#machine-learning class=md-nav__link> <span class=md-ellipsis> Machine learning </span> </a> </li> <li class=md-nav__item> <a href=https://jbcodeforce.github.io/ML-studies/ml/deep-learning/ class=md-nav__link> <span class=md-ellipsis> Deep learning </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4 id=__nav_4_label tabindex=0> <span class=md-ellipsis> Techno </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Techno </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../techno/apicurio/ class=md-nav__link> <span class=md-ellipsis> Apicurio </span> </a> </li> <li class=md-nav__item> <a href=../../techno/atlas/ class=md-nav__link> <span class=md-ellipsis> Atlas </span> </a> </li> <li class=md-nav__item> <a href=https://jbcodeforce.github.io/yarfba class=md-nav__link> <span class=md-ellipsis> AWS body of knowledge </span> </a> </li> <li class=md-nav__item> <a href=../../techno/code-engine/ class=md-nav__link> <span class=md-ellipsis> Code Engine </span> </a> </li> <li class=md-nav__item> <a href=../../techno/databricks/ class=md-nav__link> <span class=md-ellipsis> Databricks </span> </a> </li> <li class=md-nav__item> <a href=../../techno/docker/ class=md-nav__link> <span class=md-ellipsis> Docker </span> </a> </li> <li class=md-nav__item> <a href=../../techno/decisions/drools/ class=md-nav__link> <span class=md-ellipsis> Drools </span> </a> </li> <li class=md-nav__item> <a href=../../techno/egeria/ class=md-nav__link> <span class=md-ellipsis> Egeria </span> </a> </li> <li class=md-nav__item> <a href=../../techno/elasticsrch/ class=md-nav__link> <span class=md-ellipsis> Elastic Search </span> </a> </li> <li class=md-nav__item> <a href=https://jbcodeforce.github.io/flink-studies/ class=md-nav__link> <span class=md-ellipsis> Flink Studies </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_11> <label class=md-nav__link for=__nav_4_11 id=__nav_4_11_label tabindex=0> <span class=md-ellipsis> IBM </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_4_11_label aria-expanded=false> <label class=md-nav__title for=__nav_4_11> <span class="md-nav__icon md-icon"></span> IBM </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../architecture/ibmcloud/ class=md-nav__link> <span class=md-ellipsis> IBM Cloud </span> </a> </li> <li class=md-nav__item> <a href=../../architecture/satellite/ class=md-nav__link> <span class=md-ellipsis> IBM Cloud Satellite </span> </a> </li> <li class=md-nav__item> <a href=../../techno/cos/ class=md-nav__link> <span class=md-ellipsis> Cloud object storage </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_11_4> <label class=md-nav__link for=__nav_4_11_4 id=__nav_4_11_4_label tabindex=0> <span class=md-ellipsis> Cloud Pak Automation </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_4_11_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4_11_4> <span class="md-nav__icon md-icon"></span> Cloud Pak Automation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../techno/cp4a/ class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=../../techno/cp4a/bai/ class=md-nav__link> <span class=md-ellipsis> BAI </span> </a> </li> <li class=md-nav__item> <a href=../../techno/cp4a/odm/ class=md-nav__link> <span class=md-ellipsis> ODM </span> </a> </li> <li class=md-nav__item> <a href=../../techno/cp4a/ads/ class=md-nav__link> <span class=md-ellipsis> Automation Decision Service </span> </a> </li> <li class=md-nav__item> <a href=../../techno/cp4a/process-mining/ class=md-nav__link> <span class=md-ellipsis> Process mining </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_11_5> <label class=md-nav__link for=__nav_4_11_5 id=__nav_4_11_5_label tabindex=0> <span class=md-ellipsis> Cloud Pak integration </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=3 aria-labelledby=__nav_4_11_5_label aria-expanded=false> <label class=md-nav__title for=__nav_4_11_5> <span class="md-nav__icon md-icon"></span> Cloud Pak integration </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../techno/integration/cp4i/ class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=../../techno/integration/apic/ class=md-nav__link> <span class=md-ellipsis> APIC </span> </a> </li> <li class=md-nav__item> <a href=../../techno/integration/eepm/ class=md-nav__link> <span class=md-ellipsis> EEPM </span> </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_4_11_5_4> <label class=md-nav__link for=__nav_4_11_5_4 id=__nav_4_11_5_4_label tabindex=0> <span class=md-ellipsis> MQ </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=4 aria-labelledby=__nav_4_11_5_4_label aria-expanded=false> <label class=md-nav__title for=__nav_4_11_5_4> <span class="md-nav__icon md-icon"></span> MQ </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../techno/integration/mq/ class=md-nav__link> <span class=md-ellipsis> Overview </span> </a> </li> <li class=md-nav__item> <a href=../../java/mqChallenge/ class=md-nav__link> <span class=md-ellipsis> MQ challenge </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=https://jbcodeforce.github.io/kafka-studies class=md-nav__link> <span class=md-ellipsis> Kafka Studies </span> </a> </li> <li class=md-nav__item> <a href=../../techno/kar/ class=md-nav__link> <span class=md-ellipsis> KAR </span> </a> </li> <li class=md-nav__item> <a href=../../techno/microcks/ class=md-nav__link> <span class=md-ellipsis> Microcks </span> </a> </li> <li class=md-nav__item> <a href=../../techno/minikube/ class=md-nav__link> <span class=md-ellipsis> Minikube </span> </a> </li> <li class=md-nav__item> <a href=../../techno/podman/ class=md-nav__link> <span class=md-ellipsis> Podman </span> </a> </li> <li class=md-nav__item> <a href=../../techno/prometheus/ class=md-nav__link> <span class=md-ellipsis> Prometheus </span> </a> </li> <li class=md-nav__item> <a href=../../techno/rancherdesktop/ class=md-nav__link> <span class=md-ellipsis> Rancher Desktop </span> </a> </li> <li class=md-nav__item> <a href=../../techno/redis/ class=md-nav__link> <span class=md-ellipsis> Redis </span> </a> </li> <li class=md-nav__item> <a href=https://jbcodeforce.github.io/redpanda-studies/ class=md-nav__link> <span class=md-ellipsis> Red Panda </span> </a> </li> <li class=md-nav__item> <a href=../../techno/scaleway/ class=md-nav__link> <span class=md-ellipsis> Scaleway </span> </a> </li> <li class=md-nav__item> <a href=../../techno/solr/ class=md-nav__link> <span class=md-ellipsis> Solr </span> </a> </li> <li class=md-nav__item> <a href=https://jbcodeforce.github.io/spark-studies/ class=md-nav__link> <span class=md-ellipsis> Spark Studies </span> </a> </li> <li class=md-nav__item> <a href=../../java/java-vscode/ class=md-nav__link> <span class=md-ellipsis> VScode </span> </a> </li> <li class=md-nav__item> <a href=../../techno/wsl2/ class=md-nav__link> <span class=md-ellipsis> WSL2-Ubuntu </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#value-propositions class=md-nav__link> <span class=md-ellipsis> Value propositions </span> </a> <nav class=md-nav aria-label="Value propositions"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#challenges-based-on-aws-lambda-but-may-apply-to-knative class=md-nav__link> <span class=md-ellipsis> Challenges (based on AWS lambda but may apply to knative) </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#getting-started class=md-nav__link> <span class=md-ellipsis> Getting started </span> </a> </li> <li class=md-nav__item> <a href=#knative-serving class=md-nav__link> <span class=md-ellipsis> Knative serving </span> </a> <nav class=md-nav aria-label="Knative serving"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#define-a-service-for-a-docker-image class=md-nav__link> <span class=md-ellipsis> Define a service for a docker image </span> </a> </li> <li class=md-nav__item> <a href=#define-a-service-using-yaml class=md-nav__link> <span class=md-ellipsis> Define a service using yaml </span> </a> </li> <li class=md-nav__item> <a href=#knative-and-quarkus-app class=md-nav__link> <span class=md-ellipsis> Knative and Quarkus app </span> </a> </li> <li class=md-nav__item> <a href=#bluegreen-deployment class=md-nav__link> <span class=md-ellipsis> Blue/green deployment </span> </a> </li> <li class=md-nav__item> <a href=#canary-release class=md-nav__link> <span class=md-ellipsis> Canary release </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#knative-eventing class=md-nav__link> <span class=md-ellipsis> Knative eventing </span> </a> <nav class=md-nav aria-label="Knative eventing"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#source-and-sink class=md-nav__link> <span class=md-ellipsis> Source and sink </span> </a> </li> <li class=md-nav__item> <a href=#channel-and-subscribers class=md-nav__link> <span class=md-ellipsis> Channel and Subscribers </span> </a> </li> <li class=md-nav__item> <a href=#broker-and-trigger class=md-nav__link> <span class=md-ellipsis> Broker and Trigger </span> </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#some-other-cli-commands class=md-nav__link> <span class=md-ellipsis> Some other CLI commands </span> </a> </li> <li class=md-nav__item> <a href=#troubleshooting class=md-nav__link> <span class=md-ellipsis> Troubleshooting </span> </a> </li> <li class=md-nav__item> <a href=#sources class=md-nav__link> <span class=md-ellipsis> Sources </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=knative>Knative<a class=headerlink href=#knative title="Permanent link">&para;</a></h1> <p><a href=https://knative.dev/ >Knative</a> is Kubernetes based platform to develop serverless. Major value proposition is a simplified deployment syntax with automated scale-to-zero and scale-out based on HTTP load. Other interesting characteristics are:</p> <ul> <li><strong>adjust the traffic distribution</strong> amongst the service revisions, to support blue/green deployment and canary release</li> <li>able to <strong>scale to zero</strong>: After a defined time of idleness (the so called stable-window) a revision is considered inactive. Now, all routes pointing to the now inactive revision will be pointed to the so-called activator. By default the scale-to-zero-grace-period is 30s, and the stable-window is 60s.</li> <li><strong>auto-scaling</strong>: By default Knative Serving allows 100 concurrent requests into a pod. This is defined by the <code>container-concurrency-target-default</code> setting in the configmap <code>config-autoscaler</code> in the knative-serving namespace.</li> </ul> <p>Knative consists of the following components:</p> <ul> <li><a href=#knative-serving>Serving</a> - Request-driven compute that can scale to zero</li> <li><a href=#knative-eventing>Eventing</a> - Management and delivery of events</li> </ul> <p>With OpenShift it is called OpenShift Serverless, and offers operators for functions, serving and eventing. Integrated with Apache Camel connectors. </p> <h2 id=value-propositions>Value propositions<a class=headerlink href=#value-propositions title="Permanent link">&para;</a></h2> <p>Like any serverless (AWS lambda, openwhisk..) the benefits are:</p> <ul> <li>instantly spin up enough server resources to handle tens of thousands of incoming requests</li> <li>more expensive on compute time, but cost zero after</li> <li>spin up a completely separate version of the site to do some prototyping, no need to worry about forgetting a test running forever</li> <li>no Kubernetes configurations, no load balancers, no auto scaling rules</li> </ul> <h3 id=challenges-based-on-aws-lambda-but-may-apply-to-knative>Challenges (based on AWS lambda but may apply to knative)<a class=headerlink href=#challenges-based-on-aws-lambda-but-may-apply-to-knative title="Permanent link">&para;</a></h3> <ul> <li>web socket support, SMTP session</li> <li>With AWS no control of the OS, so difficult to bring your libraries. Knative as container fixes this challenge.</li> <li>AWS: functions with less RAM have slower CPU speed. This can swing a lot between 5ms to 500ms response time. Charged by 100ms increment</li> <li>Using SPA app like React or Angular, the page will be downloaded from a ContentDN server, which leads to have a delay between this web server and the function. If you want &lt;50ms response times, then hosting your backend behind API Gateway is not usable for function.</li> <li>App that needs non serverless services like VPC, NAT gateways to access other service like storage. </li> <li>to get a granular view of how long Lambdas are running, how many times... Measurement and Logging products are not serverless, so cost a lot. Specially as you may not control the information sent to the logger (like CloudWatch).</li> <li>Idempotence: AWS Lambda, can execute the same requests more than once. Which will generate multiple records written into the DB. This is due to retries on error, and event source set at least once delivery. Use request identifiers to implement idempotent Lambda functions that do not break if a function invocation needs to be retried. Make sure to pass the original request id to all subsequent calls. The original request id is generated as early as possible in the chain. If possible on the client side. Avoid generating your own ids.</li> <li>Time limit on execution to prevent deadlocked function. Difficult to see those functions as they disappear quickly.</li> <li>COLD start: if your function hasn’t been run in a while, a pending request needs to wait for it to be initialized before it can be served: 3 to 5 seconds. Nothing the end-user touches could be hosted on Lambda after all</li> <li>view Lambda mainly in terms of what it can do as a high-end parallel architecture </li> </ul> <h2 id=getting-started>Getting started<a class=headerlink href=#getting-started title="Permanent link">&para;</a></h2> <ul> <li>Install Knative CLI with <a href=https://github.com/knative/homebrew-client>brew</a>. It will be accessible via <code>kn</code></li> <li>Or use Knative CLI running in docker, <a href=https://knative.dev/docs/install/install-kn/#kn-container-images>see doc here</a></li> <li> <p>To prepare OpenShift <a href=https://docs.openshift.com/container-platform/4.7/serverless/serverless-getting-started.html>see the serverless install instructions</a>. </p> <ul> <li>The minimum requirement to use OpenShift Serverless is a cluster with 10 CPUs and 40GB memory. Use operator hub to install Knative serving and eventing servers and brokers. </li> <li>OpenShift Serverless Operator eventually shows up and its Status ultimately resolves to InstallSucceeded in the openshift-operators namespace.</li> <li>Creating the knative-serving namespace: <code>oc create namespace knative-serving</code>, and then within the project itself, create an instance. </li> <li>Verify the conditions: <code>oc get knativeserving.operator.knative.dev/knative-serving -n knative-serving --template='{{range .status.conditions}}{{printf "%s=%s\n" .type .status}}{{end}}'</code> You should get:</li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=na>DependenciesInstalled</span><span class=o>=</span><span class=s>True</span>
<a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=na>DeploymentsAvailable</span><span class=o>=</span><span class=s>True</span>
<a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=na>InstallSucceeded</span><span class=o>=</span><span class=s>True</span>
<a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=na>Ready</span><span class=o>=</span><span class=s>True</span>
</code></pre></div> <ul> <li>With a yaml file: and <code>oc apply</code> it.</li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">operator.knative.dev/v1alpha1</span>
<a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">KnativeServing</span>
<a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a><span class=nt>metadata</span><span class=p>:</span>
<a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">knative-serving</span>
<a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a><span class=w>  </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">knative-serving</span>
<a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a><span class=w>  </span><span class=nt>spec</span><span class=p>:</span>
<a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a><span class=w>    </span><span class=nt>high-availability</span><span class=p>:</span>
<a id=__codelineno-1-8 name=__codelineno-1-8 href=#__codelineno-1-8></a><span class=w>      </span><span class=nt>replicas</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
</code></pre></div> <ul> <li>We can do the same for <code>knative-eventing</code>: create a namespace and then an instance using the serverless operator. </li> <li>Verify with: <code>oc get knativeeventing.operator.knative.dev/knative-eventing -n knative-eventing --template='{{range .status.conditions}}{{printf "%s=%s\n" .type .status}}{{end}}'</code></li> </ul> </li> </ul> <h2 id=knative-serving>Knative serving<a class=headerlink href=#knative-serving title="Permanent link">&para;</a></h2> <p>Knative Serving controller creates a Configuration, a Revision, and a Route. The Knative Configuration maintains the desired state of your deployment, providing a clean separation of code and configuration. Every change to the application configuration creates a new Knative Revision.</p> <h3 id=define-a-service-for-a-docker-image>Define a service for a docker image<a class=headerlink href=#define-a-service-for-a-docker-image title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=c1># tutorial example</span>
<a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a>kn<span class=w> </span>service<span class=w> </span>create<span class=w> </span>greeter<span class=w> </span>--image<span class=w> </span>quay.io/rhdevelopers/knative-tutorial-greeter:quarkus
<a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a>
<a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a>kn<span class=w> </span>service<span class=w> </span>list
<a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a><span class=c1># Update service with env variable</span>
<a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a>kn<span class=w> </span>service<span class=w> </span>update<span class=w> </span>greeter<span class=w>  </span>--env<span class=w> </span><span class=s2>&quot;MESSAGE_PREFIX=Namaste&quot;</span>
<a id=__codelineno-2-7 name=__codelineno-2-7 href=#__codelineno-2-7></a>kn<span class=w> </span>service<span class=w> </span>describe<span class=w> </span>greeter
<a id=__codelineno-2-8 name=__codelineno-2-8 href=#__codelineno-2-8></a><span class=c1># Call service</span>
<a id=__codelineno-2-9 name=__codelineno-2-9 href=#__codelineno-2-9></a>http<span class=w> </span><span class=k>$(</span>kn<span class=w> </span>service<span class=w> </span>describe<span class=w> </span>greeter<span class=w> </span>-o<span class=w> </span>url<span class=k>)</span>
<a id=__codelineno-2-10 name=__codelineno-2-10 href=#__codelineno-2-10></a><span class=c1># Get revision list </span>
<a id=__codelineno-2-11 name=__codelineno-2-11 href=#__codelineno-2-11></a>kn<span class=w> </span>revision<span class=w> </span>list<span class=w> </span>
<a id=__codelineno-2-12 name=__codelineno-2-12 href=#__codelineno-2-12></a><span class=c1># Delete a revision</span>
<a id=__codelineno-2-13 name=__codelineno-2-13 href=#__codelineno-2-13></a>kn<span class=w> </span>revision<span class=w> </span>delete<span class=w> </span>&lt;revision-id&gt;
<a id=__codelineno-2-14 name=__codelineno-2-14 href=#__codelineno-2-14></a><span class=c1># List route</span>
<a id=__codelineno-2-15 name=__codelineno-2-15 href=#__codelineno-2-15></a>kn<span class=w> </span>route<span class=w> </span>list
<a id=__codelineno-2-16 name=__codelineno-2-16 href=#__codelineno-2-16></a><span class=c1># Destroy</span>
<a id=__codelineno-2-17 name=__codelineno-2-17 href=#__codelineno-2-17></a>kn<span class=w> </span>service<span class=w> </span>delete<span class=w> </span>greeter
</code></pre></div> <p>A revision is the immutable application and configuration state that gives you the capability to roll back to any last known good state.</p> <h3 id=define-a-service-using-yaml>Define a service using yaml<a class=headerlink href=#define-a-service-using-yaml title="Permanent link">&para;</a></h3> <p>oc apply the following definition. The Knative Service is associated with its apiVersion and kind <code>service.serving.knative.dev</code>. Liveness and readiness ports are infered from deployment.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">serving.knative.dev/v1</span>
<a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Service</span>
<a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a><span class=nt>metadata</span><span class=p>:</span>
<a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">greeter</span>
<a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a><span class=nt>spec</span><span class=p>:</span>
<a id=__codelineno-3-6 name=__codelineno-3-6 href=#__codelineno-3-6></a><span class=w> </span><span class=nt>template</span><span class=p>:</span>
<a id=__codelineno-3-7 name=__codelineno-3-7 href=#__codelineno-3-7></a><span class=w>    </span><span class=nt>metadata</span><span class=p>:</span>
<a id=__codelineno-3-8 name=__codelineno-3-8 href=#__codelineno-3-8></a><span class=w>      </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">greeter-v2</span>
<a id=__codelineno-3-9 name=__codelineno-3-9 href=#__codelineno-3-9></a><span class=w>    </span><span class=nt>spec</span><span class=p>:</span>
<a id=__codelineno-3-10 name=__codelineno-3-10 href=#__codelineno-3-10></a><span class=w>      </span><span class=nt>containers</span><span class=p>:</span>
<a id=__codelineno-3-11 name=__codelineno-3-11 href=#__codelineno-3-11></a><span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>image</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">quay.io/rhdevelopers/knative-tutorial-greeter:quarkus</span>
<a id=__codelineno-3-12 name=__codelineno-3-12 href=#__codelineno-3-12></a><span class=w>        </span><span class=nt>livenessProbe</span><span class=p>:</span>
<a id=__codelineno-3-13 name=__codelineno-3-13 href=#__codelineno-3-13></a><span class=w>          </span><span class=nt>httpGet</span><span class=p>:</span>
<a id=__codelineno-3-14 name=__codelineno-3-14 href=#__codelineno-3-14></a><span class=w>            </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">/healthz</span>
<a id=__codelineno-3-15 name=__codelineno-3-15 href=#__codelineno-3-15></a><span class=w>        </span><span class=nt>readinessProbe</span><span class=p>:</span>
<a id=__codelineno-3-16 name=__codelineno-3-16 href=#__codelineno-3-16></a><span class=w>          </span><span class=nt>httpGet</span><span class=p>:</span>
<a id=__codelineno-3-17 name=__codelineno-3-17 href=#__codelineno-3-17></a><span class=w>            </span><span class=nt>path</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">/healthz</span>
</code></pre></div> <p>Get the detail of the configuration: <code>oc get configurations.serving.knative.dev greeter</code></p> <h3 id=knative-and-quarkus-app>Knative and Quarkus app<a class=headerlink href=#knative-and-quarkus-app title="Permanent link">&para;</a></h3> <p>Be sure to have the kubernetes or openshit plugin: <code>./mvnw quarkus:add-extension -Dextensions="openshift"</code> Add the following property:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=na>quarkus.kubernetes.deployment-target</span><span class=o>=</span><span class=s>knative</span>
</code></pre></div> <p>When doing <code>mvn package</code> a <code>knative.yaml</code> file is created under <code>target/kubernetes</code></p> <div class=highlight><pre><span></span><code><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a>mvn -Dcontainer.registry.url=&#39;https://index.docker.io/v1/&#39; \
<a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a>&gt; -Dcontainer.registry.user=&#39;jbcodeforce&#39; \
<a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a>&gt; -Dcontainer.registry.password=&#39;XXXXXXXYYYYYYYZZZZZZZZ&#39; \
<a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a>&gt; -Dgit.source.revision=&#39;master&#39; \
<a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a>&gt; -Dgit.source.repo.url=&#39;https://github.com/quarkusio/quarkus-quickstarts.git&#39; \
<a id=__codelineno-5-6 name=__codelineno-5-6 href=#__codelineno-5-6></a>&gt; -Dapp.container.image=&#39;quay.io/jbcodefore/quarkus-greetings&#39; package
</code></pre></div> <p>This command creates the resource files in <code>target/kubernetes</code> directory</p> <p>Deploy the service <code>oc apply --recursive --filename target/kubernetes/</code></p> <p>Some RedHat <a href=https://developers.redhat.com/blog/2019/04/09/from-zero-to-quarkus-and-knative-the-easy-way/ >article</a>.</p> <h3 id=bluegreen-deployment>Blue/green deployment<a class=headerlink href=#bluegreen-deployment title="Permanent link">&para;</a></h3> <p>Knative offers a simple way of switching 100% of the traffic from one Knative service revision (blue) to another newly rolled out revision (green). By default new revision receives 100% of the new traffic. To rollback we need to create a yaml with the <code>template.metadata.name</code> to the expected revision and add the following spec.traffic</p> <div class=highlight><pre><span></span><code><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=w> </span><span class=nt>traffic</span><span class=p>:</span>
<a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a><span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>tag</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a><span class=w>      </span><span class=nt>revisionName</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">greeter-v1</span>
<a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a><span class=w>      </span><span class=nt>percent</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
<a id=__codelineno-6-5 name=__codelineno-6-5 href=#__codelineno-6-5></a><span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>tag</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">v2</span>
<a id=__codelineno-6-6 name=__codelineno-6-6 href=#__codelineno-6-6></a><span class=w>      </span><span class=nt>revisionName</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">greeter-v2</span>
<a id=__codelineno-6-7 name=__codelineno-6-7 href=#__codelineno-6-7></a><span class=w>      </span><span class=nt>percent</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<a id=__codelineno-6-8 name=__codelineno-6-8 href=#__codelineno-6-8></a><span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>tag</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">latest</span>
<a id=__codelineno-6-9 name=__codelineno-6-9 href=#__codelineno-6-9></a><span class=w>      </span><span class=nt>latestRevision</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<a id=__codelineno-6-10 name=__codelineno-6-10 href=#__codelineno-6-10></a><span class=w>      </span><span class=nt>percent</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
</code></pre></div> <h3 id=canary-release>Canary release<a class=headerlink href=#canary-release title="Permanent link">&para;</a></h3> <p>Knative allows you to split the traffic between revisions</p> <div class=highlight><pre><span></span><code><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=w> </span><span class=nt>traffic</span><span class=p>:</span>
<a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a><span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>tag</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a><span class=w>      </span><span class=nt>revisionName</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">greeter-v1</span>
<a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a><span class=w>      </span><span class=nt>percent</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">80</span>
<a id=__codelineno-7-5 name=__codelineno-7-5 href=#__codelineno-7-5></a><span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>tag</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">v2</span>
<a id=__codelineno-7-6 name=__codelineno-7-6 href=#__codelineno-7-6></a><span class=w>      </span><span class=nt>revisionName</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">greeter-v2</span>
<a id=__codelineno-7-7 name=__codelineno-7-7 href=#__codelineno-7-7></a><span class=w>      </span><span class=nt>percent</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">20</span>
<a id=__codelineno-7-8 name=__codelineno-7-8 href=#__codelineno-7-8></a><span class=w>    </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>tag</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">latest</span>
<a id=__codelineno-7-9 name=__codelineno-7-9 href=#__codelineno-7-9></a><span class=w>      </span><span class=nt>latestRevision</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<a id=__codelineno-7-10 name=__codelineno-7-10 href=#__codelineno-7-10></a><span class=w>      </span><span class=nt>percent</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
</code></pre></div> <h2 id=knative-eventing>Knative eventing<a class=headerlink href=#knative-eventing title="Permanent link">&para;</a></h2> <p>To use Knative eventing, we need to create a <code>knative-eventing</code> project and then in the Knative (Red Hat OpenShift serverless) operator create one instance.</p> <div class=highlight><pre><span></span><code><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">operator.knative.dev/v1alpha1</span>
<a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">KnativeEventing</span>
<a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a><span class=nt>metadata</span><span class=p>:</span>
<a id=__codelineno-8-4 name=__codelineno-8-4 href=#__codelineno-8-4></a><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">knative-eventing</span>
<a id=__codelineno-8-5 name=__codelineno-8-5 href=#__codelineno-8-5></a><span class=w>  </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">knative-eventing</span>
<a id=__codelineno-8-6 name=__codelineno-8-6 href=#__codelineno-8-6></a><span class=nt>spec</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">{}</span>
</code></pre></div> <p>Verify it runs successfully by looking at the predefined services:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a>kubectl<span class=w> </span>api-resources<span class=w> </span>--api-group<span class=o>=</span><span class=s1>&#39;sources.knative.dev&#39;</span>
</code></pre></div> <p>There are three primary usage patterns with Knative Eventing:</p> <ol> <li><strong>Source to Sink</strong>: It provides single Sink — that is, event receiving service --, with no queuing, back-pressure, and filtering. The Source to Service does not support replies, which means the response from the Sink service is ignored</li> <li><strong>Channel and subscription</strong>: the Knative Eventing system defines a Channel, which can connect to various backends such as In-Memory, Kafka and GCP PubSub for sourcing the events. Each Channel can have one or more subscribers in the form of Sink services </li> </ol> <p><img alt=1 src=https://redhat-developer-demos.github.io/knative-tutorial/knative-tutorial/eventing/_images/channels-subs.png></p> <p>When forwarding event to subscribers the channel transforms the event data as per CloudEvent specification</p> <p>To make a project using knative eventing label the namespace with: <code>kubectl label namespace jbsandbox knative-eventing-injection=enabled</code>. This will start the filter and ingress pods.</p> <h3 id=source-and-sink>Source and sink<a class=headerlink href=#source-and-sink title="Permanent link">&para;</a></h3> <p>From Red Hat tutorial, the commands to test knative eventing</p> <div class=highlight><pre><span></span><code><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a><span class=c1># Under current namespace</span>
<a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a><span class=c1># 1- Create sink</span>
<a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a>kn<span class=w> </span>service<span class=w> </span>create<span class=w> </span>eventinghello<span class=w> </span><span class=se>\</span>
<a id=__codelineno-10-4 name=__codelineno-10-4 href=#__codelineno-10-4></a><span class=w>  </span>--concurrency-target<span class=o>=</span><span class=m>1</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-10-5 name=__codelineno-10-5 href=#__codelineno-10-5></a><span class=w>  </span>--image<span class=o>=</span>quay.io/rhdevelopers/eventinghello:0.0.2
<a id=__codelineno-10-6 name=__codelineno-10-6 href=#__codelineno-10-6></a><span class=c1># A pod is created with name like  eventinghello-sdnfp-1-deployment-...</span>
<a id=__codelineno-10-7 name=__codelineno-10-7 href=#__codelineno-10-7></a>
<a id=__codelineno-10-8 name=__codelineno-10-8 href=#__codelineno-10-8></a><span class=c1># 2 Create source as a generator of json message</span>
<a id=__codelineno-10-9 name=__codelineno-10-9 href=#__codelineno-10-9></a>kn<span class=w> </span><span class=nb>source</span><span class=w> </span>ping<span class=w> </span>create<span class=w> </span>eventinghello-ping-source<span class=w> </span><span class=se>\</span>
<a id=__codelineno-10-10 name=__codelineno-10-10 href=#__codelineno-10-10></a><span class=w>  </span>--schedule<span class=w> </span><span class=s2>&quot;*/2 * * * *&quot;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-10-11 name=__codelineno-10-11 href=#__codelineno-10-11></a><span class=w>  </span>--sink<span class=w> </span>ksvc:eventinghello
<a id=__codelineno-10-12 name=__codelineno-10-12 href=#__codelineno-10-12></a><span class=c1># Verify source start to send message</span>
<a id=__codelineno-10-13 name=__codelineno-10-13 href=#__codelineno-10-13></a>kn<span class=w> </span><span class=nb>source</span><span class=w> </span>ping<span class=w> </span>list
<a id=__codelineno-10-14 name=__codelineno-10-14 href=#__codelineno-10-14></a><span class=c1># Verify sink got messages</span>
<a id=__codelineno-10-15 name=__codelineno-10-15 href=#__codelineno-10-15></a>oc<span class=w> </span>logs<span class=w> </span>&lt;sink-app-pod&gt;
<a id=__codelineno-10-16 name=__codelineno-10-16 href=#__codelineno-10-16></a><span class=c1># clean first the source then the sink</span>
<a id=__codelineno-10-17 name=__codelineno-10-17 href=#__codelineno-10-17></a>kn<span class=w> </span><span class=nb>source</span><span class=w> </span>ping<span class=w> </span>delete<span class=w> </span>eventinghello-ping-source
<a id=__codelineno-10-18 name=__codelineno-10-18 href=#__codelineno-10-18></a>kn<span class=w> </span>service<span class=w> </span>delete<span class=w> </span>eventinghello
</code></pre></div> <h3 id=channel-and-subscribers>Channel and Subscribers<a class=headerlink href=#channel-and-subscribers title="Permanent link">&para;</a></h3> <p>Here is a simple set of steps to demo channel and subscriber on the ping source</p> <div class=highlight><pre><span></span><code><a id=__codelineno-11-1 name=__codelineno-11-1 href=#__codelineno-11-1></a><span class=c1># Create the in memory channel </span>
<a id=__codelineno-11-2 name=__codelineno-11-2 href=#__codelineno-11-2></a>kn<span class=w> </span>channel<span class=w> </span>create<span class=w> </span>eventinghello-ch
<a id=__codelineno-11-3 name=__codelineno-11-3 href=#__codelineno-11-3></a>kn<span class=w> </span>channel<span class=w> </span>list
<a id=__codelineno-11-4 name=__codelineno-11-4 href=#__codelineno-11-4></a><span class=c1># Create source </span>
<a id=__codelineno-11-5 name=__codelineno-11-5 href=#__codelineno-11-5></a>kn<span class=w> </span><span class=nb>source</span><span class=w> </span>ping<span class=w> </span>create<span class=w> </span>eventinghello-ping-source<span class=w> </span><span class=se>\</span>
<a id=__codelineno-11-6 name=__codelineno-11-6 href=#__codelineno-11-6></a><span class=w>  </span>--schedule<span class=w> </span><span class=s2>&quot;*/2 * * * *&quot;</span><span class=w> </span><span class=se>\</span>
<a id=__codelineno-11-7 name=__codelineno-11-7 href=#__codelineno-11-7></a><span class=w>  </span>--sink<span class=w> </span>channel:eventinghello-ch
<a id=__codelineno-11-8 name=__codelineno-11-8 href=#__codelineno-11-8></a>kn<span class=w> </span><span class=nb>source</span><span class=w> </span>ping<span class=w> </span>list
<a id=__codelineno-11-9 name=__codelineno-11-9 href=#__codelineno-11-9></a><span class=c1># create a subscriber service</span>
<a id=__codelineno-11-10 name=__codelineno-11-10 href=#__codelineno-11-10></a>kn<span class=w> </span>service<span class=w> </span>create<span class=w> </span>eventinghelloa<span class=w> </span>--concurrency-target<span class=o>=</span><span class=m>1</span><span class=w> </span>--revision-name<span class=o>=</span>eventinghelloa-v1<span class=w> </span>--image<span class=o>=</span>quay.io/rhdevelopers/eventinghello:0.0.2
<a id=__codelineno-11-11 name=__codelineno-11-11 href=#__codelineno-11-11></a><span class=c1># Add the subscription</span>
<a id=__codelineno-11-12 name=__codelineno-11-12 href=#__codelineno-11-12></a>kn<span class=w> </span>subscription<span class=w> </span>create<span class=w>  </span>eventinghelloa-sub<span class=w> </span>--channel<span class=w> </span>eventinghello-ch<span class=w>   </span>--sink<span class=w> </span>eventinghelloa
<a id=__codelineno-11-13 name=__codelineno-11-13 href=#__codelineno-11-13></a>kn<span class=w> </span>subscription<span class=w> </span>list
<a id=__codelineno-11-14 name=__codelineno-11-14 href=#__codelineno-11-14></a><span class=c1># Clean up</span>
<a id=__codelineno-11-15 name=__codelineno-11-15 href=#__codelineno-11-15></a>kn<span class=w> </span>service<span class=w> </span>delete<span class=w> </span>eventinghello
<a id=__codelineno-11-16 name=__codelineno-11-16 href=#__codelineno-11-16></a>kn<span class=w> </span>subscription<span class=w> </span>delete<span class=w> </span>eventinghelloa-sub
<a id=__codelineno-11-17 name=__codelineno-11-17 href=#__codelineno-11-17></a>kn<span class=w> </span><span class=nb>source</span><span class=w> </span>ping<span class=w> </span>delete<span class=w> </span>eventinghello-ping-source
</code></pre></div> <h3 id=broker-and-trigger>Broker and Trigger<a class=headerlink href=#broker-and-trigger title="Permanent link">&para;</a></h3> <p>See <a href=https://redhat-developer-demos.github.io/knative-tutorial/knative-tutorial/eventing/eventing-trigger-broker.html>this tutorial</a> for basics trigger and services explanation. </p> <p><strong>Broker and Trigger</strong> supports filtering of events so subscribers specify interest on certain set of messages that flows into the Broker. For each Broker, Knative Eventing will implicitly create a Knative Eventing Channel. The Trigger gets itself subscribed to the Broker and applies the filter on the messages on its subscribed broker. The filters are applied on the on the Cloud Event attributes of the messages, before delivering it to the interested Sink Services(subscribers).</p> <p><img alt=2 src=https://redhat-developer-demos.github.io/knative-tutorial/knative-tutorial/eventing/_images/brokers-triggers.png></p> <p>When eventing is set the filter and ingress pods are started. To get the address of the broker url: <code>oc get broker default -o jsonpath='{.status.address.url}'</code></p> <p>Then the approach is to create different sinks, define triggers for each sink on what kind of event attribute to subscribe to, so filtering can occur. The sink will respond depending of the cloud event 'type' attribute for example.</p> <h2 id=some-other-cli-commands>Some other CLI commands<a class=headerlink href=#some-other-cli-commands title="Permanent link">&para;</a></h2> <div class=highlight><pre><span></span><code><a id=__codelineno-12-1 name=__codelineno-12-1 href=#__codelineno-12-1></a><span class=c1># get revisions for a service</span>
<a id=__codelineno-12-2 name=__codelineno-12-2 href=#__codelineno-12-2></a>oc<span class=w> </span>get<span class=w> </span>rev<span class=w> </span>--selector<span class=o>=</span>serving.knative.dev/service<span class=o>=</span>greeter<span class=w> </span>--sort-by<span class=o>=</span><span class=s2>&quot;{.metadata.creationTimestamp}&quot;</span>
<a id=__codelineno-12-3 name=__codelineno-12-3 href=#__codelineno-12-3></a>oc<span class=w> </span>delete<span class=w> </span>services.serving.knative.dev<span class=w> </span>greeter
</code></pre></div> <div class=highlight><pre><span></span><code><a id=__codelineno-13-1 name=__codelineno-13-1 href=#__codelineno-13-1></a><span class=c1># get revisions</span>
<a id=__codelineno-13-2 name=__codelineno-13-2 href=#__codelineno-13-2></a>kn<span class=w> </span>revision<span class=w> </span>list
<a id=__codelineno-13-3 name=__codelineno-13-3 href=#__codelineno-13-3></a>kn<span class=w> </span>revision<span class=w> </span>describe<span class=w> </span>greeter-xhwyt-1<span class=w> </span>
<a id=__codelineno-13-4 name=__codelineno-13-4 href=#__codelineno-13-4></a>
<a id=__codelineno-13-5 name=__codelineno-13-5 href=#__codelineno-13-5></a><span class=c1># route</span>
<a id=__codelineno-13-6 name=__codelineno-13-6 href=#__codelineno-13-6></a>kn<span class=w> </span>route<span class=w> </span>list
</code></pre></div> <h2 id=troubleshooting>Troubleshooting<a class=headerlink href=#troubleshooting title="Permanent link">&para;</a></h2> <p>Source of knowledge <a href=https://knative.dev/docs/serving/debugging-application-issues/ >Debugging issues with your application</a>.</p> <ul> <li>Revision failed</li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-14-1 name=__codelineno-14-1 href=#__codelineno-14-1></a>oc get configurations.serving.knative.dev item-kafka-producer
<a id=__codelineno-14-2 name=__codelineno-14-2 href=#__codelineno-14-2></a>NAME                  LATESTCREATED               LATESTREADY   READY     REASON
<a id=__codelineno-14-3 name=__codelineno-14-3 href=#__codelineno-14-3></a>item-kafka-producer   item-kafka-producer-65kbv                 False     RevisionFailed
</code></pre></div> <h2 id=sources>Sources<a class=headerlink href=#sources title="Permanent link">&para;</a></h2> <ul> <li><a href=https://knative.dev/docs/ >knative.dev</a></li> <li><a href=https://redhat-developer-demos.github.io/knative-tutorial/knative-tutorial/index.html>Red Hat knative tutorial on github</a>.</li> <li><a href=https://learning.oreilly.com/library/view/knative-cookbook>Knative Cookbook on O'Reilly portal</a></li> <li><a href=https://redhat-developer-demos.github.io/knative-tutorial/knative-tutorial/index.html>REd Hat Knative Tutorial</a></li> <li><a href=https://quarkus.io/guides/funqy-knative-events>Quarkus Funqy Knative events binding guide</a></li> <li><a href=https://github.com/lionelvillard/knative-examples>Eventing example with cloud engine - lionel villard</a></li> <li><a href=https://github.com/maximilien/knfun>Twitter to knative - michael maximilien</a></li> </ul> </article> </div> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Back to top </button> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../istio/ class="md-footer__link md-footer__link--prev" aria-label="Previous: istio"> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </div> <div class=md-footer__title> <span class=md-footer__direction> Previous </span> <div class=md-ellipsis> istio </div> </div> </a> <a href=../../code-template/ class="md-footer__link md-footer__link--next" aria-label="Next: My code templates"> <div class=md-footer__title> <span class=md-footer__direction> Next </span> <div class=md-ellipsis> My code templates </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> <div class=md-copyright__highlight> Copyright &copy; 2018 - 2024 Jerome Boyer </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> <div class=md-social> <a href=https://github.com/jbcodeforce target=_blank rel=noopener title=github.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 496 512"><!-- Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg> </a> <a href=https://linkedin.com/in/jeromeboyer target=_blank rel=noopener title=linkedin.com class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5m282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg> </a> <a href target=_blank rel=noopener title class=md-social__link> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 512 512"><!-- Font Awesome Free 6.6.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M498.1 5.6c10.1 7 15.4 19.1 13.5 31.2l-64 416c-1.5 9.7-7.4 18.2-16 23s-18.9 5.4-28 1.6L284 427.7l-68.5 74.1c-8.9 9.7-22.9 12.9-35.2 8.1S160 493.2 160 480v-83.6c0-4 1.5-7.8 4.2-10.8l167.6-182.8c5.8-6.3 5.6-16-.4-22s-15.7-6.4-22-.7L106 360.8l-88.3-44.2C7.1 311.3.3 300.7 0 288.9s5.9-22.8 16.1-28.7l448-256c10.7-6.1 23.9-5.5 34 1.4"/></svg> </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <div class=md-progress data-md-component=progress role=progressbar></div> <script id=__config type=application/json>{"base": "../..", "features": ["content.code.annotate", "content.code.copy", "content.tooltips", "search.highlight", "navigation.instant", "navigation.instant.progress", "navigation.tabs", "navigation.instant", "navigation.tabs.sticky", "navigation.tracking", "navigation.footer", "navigation.tabs.sticky", "navigation.top"], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script> <script src=../../assets/javascripts/bundle.525ec568.min.js></script> </body> </html>